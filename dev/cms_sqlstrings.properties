#
# CMSSQLStrings properties
System.Configuration.cms_sqlstrings.fName=cms_sqlstrings
System.Configuration.cms_sqlstrings.ConfigurationSource=SQL_STRINGS
System.Configuration.cms_sqlstrings.verbose=false
System.Configuration.cms_sqlstrings.canEdit=false
System.Configuration.cms_sqlstrings.canView=false
System.Configuration.cms_sqlstrings.required=false


business.kss.getgenericgtorvalidations = select 'validation triggered1' from dual

business.kss.validations = SELECT CHECK_GENERIC_SW,CHECK_OVERLAP_SW,CHECK_MINMAX_SW,NOTIFICATION_SW FROM CMSLEAVEVALIDATION WHERE REQUEST_TYPE = ?

business.kss.getminmaxtakinglimits = SELECT DBO.MAXMINTAKINGLIMITS1  (?,?,?,?,?,?)

# CMS SQL strings

business.cms.SELECT_BASIC_WAGE_FROM_PEOPLE_EDITOOR_BY_PERSONNUM= \
SELECT trunc(s.basewagehourlyamt,2) FROM VP_EMPLOYEEV42 VP JOIN (SELECT bw.*, MAX(bw.effectivedtm) OVER (PARTITION BY EMPLOYEEID) max_date \
FROM BASEWAGERTHIST bw) s ON VP.PERSONID = s.EMPLOYEEID WHERE s.effectivedtm = max_date and VP.personnum = ?

business.cms.SELECT_AllInterfaceNames= \
select  KNXINTERFACEID, KNXINTERFACENM, KNXINTERFACEDSC FROM KNXINTERFACE

business.cms.SELECT_InterfaceNames= \
select  KNXINTERFACEID, KNXINTERFACENM, KNXINTERFACEDSC FROM KNXINTERFACE \
where KNXINTERFACEID in (SELECT IDENTIFIERID FROM DAGITEM WHERE DATAACCESSGRPID \
in (select a.DATAACCESSGRPID from ASSIGNDAG a inner join DATAACCESSGRP d on \
a.DATAACCESSGRPID=d.DATAACCESSGRPID where PERSONID =?) AND DAGENTITYID = \
(select dagentity.DAGENTITYID from dagentity where dagentitynm like '%interfaces'))

business.cms.SELECT_BY_CODE=\
select UNITID, NAME, ADDRESS, MANAGERNAME, MANAGERADDRS, BUSINESSTYPE, MAXWORKMEN, MAXCNTRWORKMEN,\
BOCWAPPLICABILITY, ISMWAPPLICABILITY, LICENSENUMBER, PFCODE, ESWC, CODE, ORGANIZATION from CMSPRINCIPALEMPLOYER WHERE CODE = ?

business.cms.SELECT_BY_ID=\
select UNITID, NAME, ADDRESS, MANAGERNAME, MANAGERADDRS, BUSINESSTYPE, MAXWORKMEN, MAXCNTRWORKMEN,\
BOCWAPPLICABILITY, ISMWAPPLICABILITY, LICENSENUMBER, PFCODE, ESWC, CODE, ORGANIZATION from CMSPRINCIPALEMPLOYER WHERE UNITID = ?

business.cms.SELECT_ALL=\
select UNITID, NAME, ADDRESS, MANAGERNAME, MANAGERADDRS, BUSINESSTYPE, MAXWORKMEN, MAXCNTRWORKMEN,\
BOCWAPPLICABILITY, ISMWAPPLICABILITY, LICENSENUMBER, PFCODE, ESWC, CODE, ORGANIZATION from CMSPRINCIPALEMPLOYER

cms.business.Update=\
UPDATE CMSPRINCIPALEMPLOYER SET ADDRESS=?, MANAGERNAME=?, MANAGERADDRS=?, BUSINESSTYPE= ?, MAXWORKMEN=?, MAXCNTRWORKMEN=?,\
BOCWAPPLICABILITY=?, ISMWAPPLICABILITY=?, LICENSENUMBER=?, PFCODE=?, ESWC=? WHERE UNITID=?

cms.business.SELECT_PE_PROPS_BY_UNITNAME=\
select PROPERTYID,FIELDNAME, FIELDVALUE from CMSPRINCIPALEMP1M WHERE UNITID =(SELECT UNITID FROM CMSPRINCIPALEMPLOYER WHERE NAME=?)
 
business.cms.SELECT_PE_PROPS_BY_UNITID=\
select PROPERTYID, FIELDNAME, FIELDVALUE from CMSPRINCIPALEMP1M WHERE UNITID = ?

business.cms.DELETE_ALL_CONFIG_PROPERTIES=\
DELETE FROM CMSPRINCIPALEMP1M WHERE UNITID=?

business.cms.INSERT_CONFIG_PROPERTY=\
INSERT INTO CMSPRINCIPALEMP1M VALUES(?,?,?,?)

# contractor

business.cms.SELECT_CONTRACTOR_BY_NAME=\
select A.CONTRACTORID ,UNITID, NAME, ADDRESS,CODE,MANAGERNM,ESIWC ,LICENSENUM,VALIDFROMDT,VALIDTODT,COVERAGE,TOTALSTRENGTH,MAXNOEMP,\
NATUREOFWORK,LOCOFWORK ,PERIODSTARTDT,	PERIODENDDT ,VENDORCODE, PFCODE ,ESIVALIDFROM ,ESIVALIDTO,ESIWCCOVERAGE,PFNUM,PFAPPLYDT, IS_BLOCKED,COMMISSION, \
PFCOVERAGE, PFPAIDBYSELF, ESIPAIDBYSELF, LICENSENUM1,VALIDFROMDT1,VALIDTODT1 \
from cMSCONTRACTOR A, CMSCONTRPEMM B, CMSVENDOR C WHERE A.CONTRACTORID =B.CONTRACTORID AND B.VENDORID = C.VENDORID AND A.NAME=? order by NAME

business.cms.SELECT_CONTRACTOR_BY_NAME_UNITID=\
select A.CONTRACTORID ,UNITID, NAME, ADDRESS,CODE,MANAGERNM,ESIWC ,LICENSENUM,VALIDFROMDT,VALIDTODT,COVERAGE,TOTALSTRENGTH,MAXNOEMP,\
NATUREOFWORK,LOCOFWORK ,PERIODSTARTDT,	PERIODENDDT ,VENDORCODE, PFCODE ,ESIVALIDFROM ,ESIVALIDTO,ESIWCCOVERAGE,PFNUM,PFAPPLYDT, IS_BLOCKED,COMMISSION, \
PFCOVERAGE, PFPAIDBYSELF, ESIPAIDBYSELF, LICENSENUM1,VALIDFROMDT1,VALIDTODT1 \
from cMSCONTRACTOR A, CMSCONTRPEMM B, CMSVENDOR C WHERE A.CONTRACTORID =B.CONTRACTORID AND B.VENDORID = C.VENDORID AND A.NAME LIKE ? \
AND UNITID=? order by NAME

business.cms.SELECT_CONTRACTOR_BY_CODE_UNITID=\
select A.CONTRACTORID ,UNITID, NAME, ADDRESS,CODE,MANAGERNM,ESIWC ,LICENSENUM,VALIDFROMDT,VALIDTODT,COVERAGE,TOTALSTRENGTH,MAXNOEMP,\
NATUREOFWORK,LOCOFWORK ,PERIODSTARTDT,	PERIODENDDT ,VENDORCODE, PFCODE ,ESIVALIDFROM ,ESIVALIDTO,ESIWCCOVERAGE,PFNUM,PFAPPLYDT, IS_BLOCKED,COMMISSION, \
PFCOVERAGE, PFPAIDBYSELF, ESIPAIDBYSELF, LICENSENUM1,VALIDFROMDT1,VALIDTODT1 \
from cMSCONTRACTOR A, CMSCONTRPEMM B, CMSVENDOR C WHERE A.CONTRACTORID =B.CONTRACTORID AND B.VENDORID = C.VENDORID AND C.VENDORCODE=? \
AND UNITID=? order by NAME

business.cms.SELECT_CONTRACTOR_BY_ID=\
select A.CONTRACTORID ,UNITID, NAME, ADDRESS,CODE,MANAGERNM,ESIWC ,LICENSENUM,VALIDFROMDT,VALIDTODT,COVERAGE,TOTALSTRENGTH,MAXNOEMP,\
NATUREOFWORK,LOCOFWORK ,PERIODSTARTDT,	PERIODENDDT ,VENDORCODE ,PFCODE ,ESIVALIDFROM ,ESIVALIDTO, ESIWCCOVERAGE ,PFNUM,PFAPPLYDT,IS_BLOCKED,COMMISSION, \
PFCOVERAGE, PFPAIDBYSELF, ESIPAIDBYSELF, LICENSENUM1,VALIDFROMDT1,VALIDTODT1 \
from cMSCONTRACTOR A, CMSCONTRPEMM B, CMSVENDOR C WHERE A.CONTRACTORID =B.CONTRACTORID AND B.VENDORID = C.VENDORID AND A.CONTRACTORID=? \
and UNITID = ? order by NAME

business.cms.SELECT_ALL_CONTRACTORS=\
select A.CONTRACTORID ,UNITID, NAME, ADDRESS,CODE,MANAGERNM,ESIWC ,LICENSENUM,VALIDFROMDT,VALIDTODT,COVERAGE,TOTALSTRENGTH,MAXNOEMP,\
NATUREOFWORK,LOCOFWORK ,PERIODSTARTDT,	PERIODENDDT ,VENDORCODE ,	PFCODE ,ESIVALIDFROM ,ESIVALIDTO,ESIWCCOVERAGE ,PFNUM,PFAPPLYDT, IS_BLOCKED, COMMISSION, \
PFCOVERAGE, PFPAIDBYSELF, ESIPAIDBYSELF, LICENSENUM1,VALIDFROMDT1,VALIDTODT1 \
from cMSCONTRACTOR A, CMSCONTRPEMM B, CMSVENDOR C WHERE A.CONTRACTORID =B.CONTRACTORID AND B.VENDORID = C.VENDORID order by NAME

cms.business.UPDATECONTRACTOR=\
UPDATE CMSCONTRACTOR SET ADDRESS=?, CODE=? WHERE CONTRACTORID=?

cms.business.UPDATECONTRACTOR1M=\
UPDATE CMSCONTRPEMM SET MANAGERNM=?,ESIWC=?,LICENSENUM=?,VALIDFROMDT=?,VALIDTODT=?,COVERAGE=?,TOTALSTRENGTH=?,MAXNOEMP=?,\
NATUREOFWORK=?,LOCOFWORK=?,PERIODSTARTDT=?,PERIODENDDT=?,PFCODE=?,ESIVALIDFROM=?,ESIVALIDTO=?, ESIWCCOVERAGE=?,PFNUM=?,PFAPPLYDT=?,COMMISSION=?, \
PFCOVERAGE=?, PFPAIDBYSELF=?, ESIPAIDBYSELF=?, LICENSENUM1 = ?, VALIDFROMDT1 = ?, VALIDTODT1 = ? \
WHERE CONTRACTORID =? AND UNITID=?

business.cms.SELECT_CONTRACTOR_BY_UNITID=\
select cMSCONTRACTOR.CONTRACTORID ,UNITID, NAME, ADDRESS,CODE, MANAGERNM,ESIWC ,LICENSENUM,VALIDFROMDT,VALIDTODT,COVERAGE,TOTALSTRENGTH,MAXNOEMP,\
NATUREOFWORK,LOCOFWORK ,PERIODSTARTDT,	PERIODENDDT ,VENDORCODE , PFCODE ,ESIVALIDFROM ,ESIVALIDTO,ESIWCCOVERAGE ,PFNUM,PFAPPLYDT, IS_BLOCKED,COMMISSION, \
PFCOVERAGE, PFPAIDBYSELF, ESIPAIDBYSELF, LICENSENUM1, VALIDFROMDT1, VALIDTODT1 \
from cMSCONTRACTOR, CMSCONTRPEMM, CMSVENDOR WHERE cMSCONTRACTOR.CONTRACTORID =CMSCONTRPEMM.CONTRACTORID AND \
CMSCONTRPEMM.VENDORID = CMSVENDOR.VENDORID AND UNITID=? order by NAME

business.cms.SELECT_DEPT_BY_UNITID=\
SELECT DEPID,NAME,DESCRIPTION,UNITID FROM CMSDEPT WHERE UNITID=? order by NAME

business.cms.SELECT_DEPT_BY_DEPTID=\
SELECT DEPID, NAME, DESCRIPTION,UNITID FROM CMSDEPT WHERE DEPID=? order by NAME

business.cms.SELECT_MANAGERS_BY_DEPTID=\
SELECT MANAGERID, NAME,DEPID, SECID, USERNAME, PASSWORD, EMAILADDR, MOBILENO, ISDEPTMGR, PERSONID FROM CMSMANAGERS WHERE DEPID=? ORDER BY MANAGERID DESC

business.cms.SELECT_MANAGERS_BY_DEPTID_1=\
SELECT CM.MANAGERID,CM.NAME,CS.DEPTID,CS.SECID,CM.USERNAME,CM.PASSWORD,CM.EMAILADDR,CM.MOBILENO,CM.ISDEPTMGR,CM.PERSONID \
FROM CMSSECTION CS LEFT JOIN CMSMANAGERS CM ON CM.SECID=CS.SECID AND CS.DEPTID=CM.DEPID \
WHERE CS.DEPTID=? ORDER BY CM.MANAGERID DESC

business.cms.SELECT_MANAGERS_BY_ID=\
SELECT MANAGERID, NAME,DEPID, SECID, USERNAME, PASSWORD, EMAILADDR, MOBILENO, ISDEPTMGR, PERSONID FROM CMSMANAGERS WHERE MANAGERID=? ORDER BY MANAGERID DESC

business.cms.INSERT_MANAGER=\
INSERT INTO CMSMANAGERS VALUES(?,?,?,?,?,?,?,?,?,?)

business.cms.UPDATE_MANAGER=\
UPDATE CMSMANAGERS SET NAME = ? ,DEPID = ?, SECID = ?, USERNAME =?, PASSWORD=?, EMAILADDR=?, MOBILENO=?, ISDEPTMGR=? WHERE MANAGERID=?

business.cms.DELETE_MANAGER=\
DELETE FROM CMSMANAGERS WHERE MANAGERID=?

business.cms.SELECT_SECTION_BY_DEPID=\
SELECT SECID, NAME, CODE, DESCRIPTION, DEPTID FROM CMSSECTION WHERE DEPTID=?

business.cms.SELECT_ALL_SKILLS=\
SELECT SKILLID, SKILLNM FROM CMSSKILL

business.cms.SELECT_ALL_TRADES=\
SELECT TRADEID, NAME, DESCRIPTION FROM CMSTRADE order by NAME

business.cms.SELECT_TRADES_BY_ID=\
SELECT TRADEID, NAME, DESCRIPTION FROM CMSTRADE WHERE TRADEID=?

business.cms.SELECT_SKILL_BY_ID=\
SELECT SKILLID, SKILLNM FROM CMSSKILL WHERE SKILLID=?

business.cms.SELECT_ADDRESS_BY_ID=\
SELECT ADDRESSID,STREET,TALUKA, DISTRICT, VILLAGE,STATEID FROM CMSADDRESS WHERE ADDRESSID=?
#Author Sam
#NEW REQ VDA PDA 28 COMPONENTS
business.cms.SELECT_WAGE_BY_ID=\
SELECT  WAGEID , BASIC , DA , ALLOWANCE , PERDAYALLOWANCE, MONTHLYALLOWANCE, COMMISSION, EFFECTIVEDATE, VDA , PDA , HRA , CONVEYANCE , \
SPECIAL_ALLOWANCE , SHIFT_ALLOWANCE , DUST_ALLOWANCE_MONTHLY , MEDICAL_ALLOWANCE , LTA , EDUCATION_ALLOWANCE, OTHER_ALLOWANCE, COMMISSION_AMT,  \
FITMENT_ALLOWANCE  , RETENTION_ALLOWANCE  , GUN_ALLOWANCE  , UNIFORM_ALLOWANCE ,VARIABLE_ALLOWANCE_AMT,	TA,	SKILL_DEVELOPMENT_ALLOWANCE,	\
DEP_COMP_ALLOW,	WASHING_ALLOWANCE,	SITE_ALLOWANCE,	MOBILE_ALLOWANCE,	SKILLED_ALLOWANCE,	PF,	ESIC,	ADMIN_CHARGES,	ADMIN_EDLI,	\
TOOLS_AND_TACKLES,	CONSULTANCY_CHARGES,	ADVANCE_BONUS,	ENTERTAINMENT_EXPENSES,	CLUB_EXPENSES,	VEHICLE_REIMBURSEMENT,	\
VEHICLE_EXPENSE_REIMBURSEMENT,	FUEL_EXPENSES,	FUEL_EXPENSES_1,	PERIODICAL_MAGAZINE_EXPENSES,	PERSONAL_PAY,	INCENTIVE_ALL,	\
ADDITIONAL_ALLOWANCE,	ADDITIONAL_ALLOWANCE_2,	ADDITIONAL_ALLOWANCE_3,	PENSION FROM  CMSWAGE WHERE WAGEID=?
#SELECT  WAGEID , BASIC , DA , ALLOWANCE , PERDAYALLOWANCE, MONTHLYALLOWANCE, COMMISSION, EFFECTIVEDATE, VDA , PDA , HRA , CONVEYANCE , \
#SPECIAL_ALLOWANCE , SHIFT_ALLOWANCE , DUST_ALLOWANCE_MONTHLY , MEDICAL_ALLOWANCE , LTA , EDUCATION_ALLOWANCE, OTHER_ALLOWANCE, COMMISSION_AMT,  \
#FITMENT_ALLOWANCE  , RETENTION_ALLOWANCE  , GUN_ALLOWANCE  , UNIFORM_ALLOWANCE FROM  CMSWAGE WHERE WAGEID=?
#SELECT WAGEID, BASIC, DA, ALLOWANCE,PERDAYALLOWANCE, MONTHLYALLOWANCE, COMMISSION, EFFECTIVEDATE FROM CMSWAGE WHERE WAGEID=?
#SELECT WAGEID, BASIC, DA, ALLOWANCE FROM CMSWAGE WHERE WAGEID=?
#Author Sam
business.cms.SELECT_WAGE_BY_ID1=\
SELECT  WAGEID , BASIC , DA , ALLOWANCE , PERDAYALLOWANCE, MONTHLYALLOWANCE, COMMISSION, EFFECTIVEDATE, VDA , PDA , HRA , CONVEYANCE , \
SPECIAL_ALLOWANCE , SHIFT_ALLOWANCE , DUST_ALLOWANCE_MONTHLY , MEDICAL_ALLOWANCE , LTA , EDUCATION_ALLOWANCE, OTHER_ALLOWANCE, COMMISSION_AMT, \
FITMENT_ALLOWANCE  , RETENTION_ALLOWANCE  , GUN_ALLOWANCE  , UNIFORM_ALLOWANCE ,VARIABLE_ALLOWANCE_AMT,	TA,	SKILL_DEVELOPMENT_ALLOWANCE,	\
DEP_COMP_ALLOW,	WASHING_ALLOWANCE,	SITE_ALLOWANCE,	MOBILE_ALLOWANCE,	SKILLED_ALLOWANCE,	PF,	ESIC,	ADMIN_CHARGES,	ADMIN_EDLI,	\
TOOLS_AND_TACKLES,	CONSULTANCY_CHARGES,	ADVANCE_BONUS,	ENTERTAINMENT_EXPENSES,	CLUB_EXPENSES,	VEHICLE_REIMBURSEMENT,	\
VEHICLE_EXPENSE_REIMBURSEMENT,	FUEL_EXPENSES,	FUEL_EXPENSES_1,	PERIODICAL_MAGAZINE_EXPENSES,	PERSONAL_PAY,	INCENTIVE_ALL,	\
ADDITIONAL_ALLOWANCE,	ADDITIONAL_ALLOWANCE_2,	ADDITIONAL_ALLOWANCE_3,	PENSION FROM  CMSWAGE1 WHERE WAGEID=?
#SELECT  WAGEID , BASIC , DA , ALLOWANCE , PERDAYALLOWANCE, MONTHLYALLOWANCE, COMMISSION, EFFECTIVEDATE, VDA , PDA , HRA , CONVEYANCE , \
#SPECIAL_ALLOWANCE , SHIFT_ALLOWANCE , DUST_ALLOWANCE_MONTHLY , MEDICAL_ALLOWANCE , LTA , EDUCATION_ALLOWANCE, OTHER_ALLOWANCE, COMMISSION_AMT, \
#FITMENT_ALLOWANCE  , RETENTION_ALLOWANCE  , GUN_ALLOWANCE  , UNIFORM_ALLOWANCE FROM  CMSWAGE1 WHERE WAGEID=?
#NEW REQ
business.cms.INSERT_CMSWAGE=\
INSERT INTO CMSWAGE (WAGEID, BASIC, DA, ALLOWANCE,PERDAYALLOWANCE, MONTHLYALLOWANCE, COMMISSION, EFFECTIVEDATE,VDA , PDA , HRA , CONVEYANCE , \
SPECIAL_ALLOWANCE , SHIFT_ALLOWANCE , DUST_ALLOWANCE_MONTHLY , MEDICAL_ALLOWANCE , LTA , EDUCATION_ALLOWANCE, OTHER_ALLOWANCE, COMMISSION_AMT, \
FITMENT_ALLOWANCE  , RETENTION_ALLOWANCE  , GUN_ALLOWANCE  , UNIFORM_ALLOWANCE,VARIABLE_ALLOWANCE_AMT,	TA,	SKILL_DEVELOPMENT_ALLOWANCE,	\
DEP_COMP_ALLOW,	WASHING_ALLOWANCE,	SITE_ALLOWANCE,	MOBILE_ALLOWANCE,	SKILLED_ALLOWANCE,	PF,	ESIC,	ADMIN_CHARGES,	ADMIN_EDLI,	\
TOOLS_AND_TACKLES,	CONSULTANCY_CHARGES,	ADVANCE_BONUS,	ENTERTAINMENT_EXPENSES,	CLUB_EXPENSES,	VEHICLE_REIMBURSEMENT,	\
VEHICLE_EXPENSE_REIMBURSEMENT,	FUEL_EXPENSES,	FUEL_EXPENSES_1,	PERIODICAL_MAGAZINE_EXPENSES,	PERSONAL_PAY,	INCENTIVE_ALL,	\
ADDITIONAL_ALLOWANCE,	ADDITIONAL_ALLOWANCE_2,	ADDITIONAL_ALLOWANCE_3,	PENSION ) \
VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
#INSERT INTO CMSWAGE (WAGEID, BASIC, DA, ALLOWANCE,PERDAYALLOWANCE, MONTHLYALLOWANCE, COMMISSION, EFFECTIVEDATE,VDA , PDA , HRA , CONVEYANCE , \
#SPECIAL_ALLOWANCE , SHIFT_ALLOWANCE , DUST_ALLOWANCE_MONTHLY , MEDICAL_ALLOWANCE , LTA , EDUCATION_ALLOWANCE, OTHER_ALLOWANCE, COMMISSION_AMT, \
#FITMENT_ALLOWANCE  , RETENTION_ALLOWANCE  , GUN_ALLOWANCE  , UNIFORM_ALLOWANCE ) \
#VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
#INSERT INTO CMSWAGE (WAGEID, BASIC, DA, ALLOWANCE,PERDAYALLOWANCE, MONTHLYALLOWANCE, COMMISSION, EFFECTIVEDATE) VALUES(?,?,?,?,?,?,?,?)
#INSERT INTO CMSWAGE (WAGEID, BASIC, DA, ALLOWANCE) VALUES(?,?,?,?)
#Author Sam
business.cms.INSERT_CMSWAGE1=\
INSERT INTO CMSWAGE1 (WAGEID, BASIC, DA, ALLOWANCE,PERDAYALLOWANCE, MONTHLYALLOWANCE, COMMISSION, EFFECTIVEDATE,VDA , PDA , HRA , CONVEYANCE , \
SPECIAL_ALLOWANCE , SHIFT_ALLOWANCE , DUST_ALLOWANCE_MONTHLY , MEDICAL_ALLOWANCE , LTA , EDUCATION_ALLOWANCE, OTHER_ALLOWANCE, COMMISSION_AMT, \
FITMENT_ALLOWANCE  , RETENTION_ALLOWANCE  , GUN_ALLOWANCE  , UNIFORM_ALLOWANCE,VARIABLE_ALLOWANCE_AMT,	TA,	SKILL_DEVELOPMENT_ALLOWANCE,	\
DEP_COMP_ALLOW,	WASHING_ALLOWANCE,	SITE_ALLOWANCE,	MOBILE_ALLOWANCE,	SKILLED_ALLOWANCE,	PF,	ESIC,	ADMIN_CHARGES,	ADMIN_EDLI,	\
TOOLS_AND_TACKLES,	CONSULTANCY_CHARGES,	ADVANCE_BONUS,	ENTERTAINMENT_EXPENSES,	CLUB_EXPENSES,	VEHICLE_REIMBURSEMENT,	\
VEHICLE_EXPENSE_REIMBURSEMENT,	FUEL_EXPENSES,	FUEL_EXPENSES_1,	PERIODICAL_MAGAZINE_EXPENSES,	PERSONAL_PAY,	INCENTIVE_ALL,	\
ADDITIONAL_ALLOWANCE,	ADDITIONAL_ALLOWANCE_2,	ADDITIONAL_ALLOWANCE_3,	PENSION ) \
VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
#INSERT INTO CMSWAGE1 (WAGEID, BASIC, DA, ALLOWANCE,PERDAYALLOWANCE, MONTHLYALLOWANCE, COMMISSION, EFFECTIVEDATE,VDA , PDA , HRA , CONVEYANCE , \
#SPECIAL_ALLOWANCE , SHIFT_ALLOWANCE , DUST_ALLOWANCE_MONTHLY , MEDICAL_ALLOWANCE , LTA , EDUCATION_ALLOWANCE, OTHER_ALLOWANCE, COMMISSION_AMT, \
#FITMENT_ALLOWANCE  , RETENTION_ALLOWANCE  , GUN_ALLOWANCE  , UNIFORM_ALLOWANCE ) \
#VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
#Author Sam
#NEW REQ
business.cms.UPDATE_CMSWAGE=\
UPDATE CMSWAGE SET BASIC=?, DA=?, ALLOWANCE=?, PERDAYALLOWANCE =?, MONTHLYALLOWANCE = ?, \
COMMISSION = ?, EFFECTIVEDATE = ?,VDA = ?, PDA = ?, HRA = ?, CONVEYANCE = ?, \
SPECIAL_ALLOWANCE = ?, SHIFT_ALLOWANCE = ?, DUST_ALLOWANCE_MONTHLY = ?, MEDICAL_ALLOWANCE = ?, LTA = ?, EDUCATION_ALLOWANCE = ?, \
OTHER_ALLOWANCE = ?, COMMISSION_AMT = ?, FITMENT_ALLOWANCE = ?, RETENTION_ALLOWANCE = ? , GUN_ALLOWANCE = ? , UNIFORM_ALLOWANCE = ?, \
VARIABLE_ALLOWANCE_AMT= ?,	TA= ?,	SKILL_DEVELOPMENT_ALLOWANCE= ?,	DEP_COMP_ALLOW= ?,	WASHING_ALLOWANCE= ?,	SITE_ALLOWANCE= ?,	\
MOBILE_ALLOWANCE= ?,	SKILLED_ALLOWANCE= ?,	PF= ?,	ESIC= ?,	ADMIN_CHARGES= ?,	ADMIN_EDLI= ?,	TOOLS_AND_TACKLES= ?,	\
CONSULTANCY_CHARGES= ?,	ADVANCE_BONUS= ?,	ENTERTAINMENT_EXPENSES= ?,	CLUB_EXPENSES= ?,	VEHICLE_REIMBURSEMENT= ?, \
VEHICLE_EXPENSE_REIMBURSEMENT= ?,	FUEL_EXPENSES= ?,	FUEL_EXPENSES_1= ?,	PERIODICAL_MAGAZINE_EXPENSES= ?,	PERSONAL_PAY= ?,	\
INCENTIVE_ALL= ?,	ADDITIONAL_ALLOWANCE= ?,	ADDITIONAL_ALLOWANCE_2= ?,	ADDITIONAL_ALLOWANCE_3= ?,	PENSION = ? WHERE WAGEID=?
#UPDATE CMSWAGE SET BASIC=?, DA=?, ALLOWANCE=?, PERDAYALLOWANCE =?, MONTHLYALLOWANCE = ?, \
#COMMISSION = ?, EFFECTIVEDATE = ?,VDA = ?, PDA = ?, HRA = ?, CONVEYANCE = ?, \
#SPECIAL_ALLOWANCE = ?, SHIFT_ALLOWANCE = ?, DUST_ALLOWANCE_MONTHLY = ?, MEDICAL_ALLOWANCE = ?, LTA = ?, EDUCATION_ALLOWANCE = ?, \
#OTHER_ALLOWANCE = ?, COMMISSION_AMT = ?, FITMENT_ALLOWANCE = ?, RETENTION_ALLOWANCE = ? , GUN_ALLOWANCE = ? , UNIFORM_ALLOWANCE = ? WHERE WAGEID=?
#UPDATE CMSWAGE SET BASIC=?, DA=?, ALLOWANCE=?, PERDAYALLOWANCE =?, MONTHLYALLOWANCE = ?, \
#COMMISSION = ?, EFFECTIVEDATE = ? WHERE WAGEID=?
#UPDATE CMSWAGE SET BASIC=?, DA=?, ALLOWANCE=? WHERE WAGEID=?

business.cms.INSERT_CMSADDRESS=\
INSERT INTO CMSADDRESS VALUES(?,?,?,?,?,?)
#AUTHOR SAM
business.cms.INSERT_PERSONDETL=\
INSERT INTO CMSPERSONDETL VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,NULL,?,?)


business.cms.UPDATE_PERSONDETL=\
UPDATE CMSPERSONDETL \
   SET DOJ = ? \ 
      , DOT = ? \ 
      , PFANO = ? \
      , AADHARNO  = ? \
      , GENDER  = ? \
      , PANNO  = ? \
      , HAZAREA  = ? \
      , MARITAL  = ? \
      , WIFENM  = ? \
      , CHLDRNO  = ? \
      , TECH  = ? \
      , ACADS  = ? \
      , PLIC1  = ? \
      , PLIC2  = ? \
      , PLIC3  = ? \
      , PLIC4  = ? \
      , PEMP  = ? \
      , PCONTR  = ? \
      , REFERREDBY  = ? \
      , SHOESIZE  = ? \
      , BLOODGRP  = ? \
      , AMCDTM  = ? \
      , WINCORELATIVE  = ? \
      , WINCONAME  = ? \
      , WINCOMADDRESSID  = ? \
      , MOBILENO  = ? \
      , LANDLOSER  = ? \
      , SURVEYNO  = ? \
      , RELWITHSLLR  = ? \
      , VILLAGE  = ? \
      , NAMEOFSELLER  = ? \
      , EXTENT  = ? \
      , ACTCONTRSW  = ? \
      , BANKBRANCH  = ? \
      , ACCTNO  = ? \
      , MEDICALTRNSW  = ? \
      , SAFETYTRNSW  = ? \
      , SKILLCERTSW  = ? \
      , EXPERIENCE = ? \
      , PREVOGRANIZATION = ?\
      ,INACTIVEDATE = ? \
      ,REASONOFLEAVING = ? \
      ,OTHERREASONOFLEAVING =? \
 WHERE PERSONDETLID=?
#merged

business.cms.INSERT_CMSPERSON=\
INSERT INTO CMSPERSON (EMPLOYEEID,EMPLOYEECODE,FIRSTNAME,LASTNAME,RELATIONNAME,DOB,IDMARK,TRADEID,SKILLID,PRESENTADDRID,PERMADDRID,PERSONDETLID,WAGEID,CONTRACTORID,STATUS,PERSONID,ISLS,UNITID,ETYPE,LTYPE,NOJEFFDT) \
VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)

#merged
business.cms.REHIRE_CMSPERSON=UPDATE CMSPERSON SET STATUS=?,TRADEID=?,SKILLID=?,UNITID=?,CONTRACTORID=?, ETYPE = ?, LTYPE = ?, NOJEFFDT = ? WHERE EMPLOYEEID=?
#Modified By Sam
business.cms.REHIRE_CMSPERSONDETL=UPDATE CMSPERSONDETL SET DOJ = ?, DOT=?, REASONOFLEAVING = null  WHERE PERSONDETLID=(SELECT PERSONDETLID FROM CMSPERSON WHERE EMPLOYEEID=?)
#merged
business.cms.UPDATE_CMSPERSON=\
UPDATE CMSPERSON \
   SET FIRSTNAME = ? \
      ,LASTNAME = ? \
      ,RELATIONNAME = ? \
      ,DOB = ? \
      ,IDMARK = ? \
      ,TRADEID = ? \
      ,SKILLID = ? \
      ,PRESENTADDRID = ? \
      ,PERMADDRID = ? \
      ,PERSONDETLID = ? \
      ,WAGEID = ? \
      ,CONTRACTORID = ? \
      ,STATUS = ? \
      ,EMPLOYEECODE = ? \
      ,ISLS = ? \
      ,UNITID = ? \
      ,ETYPE = ? \
      ,LTYPE = ? \
      ,NOJEFFDT = ? \
 WHERE EMPLOYEEID = ?
#merged
business.cms.INSERT_CMSPERSONHISTORY=\
INSERT INTO CMSPERSONHISTORY (EMP_ID , FIRST_NAME , LAST_NAME , GENDER , PREVIOUS_EXPERIENCE , PREVIOUS_ORG , EMP_CODE , \
RLTN_NAME , DOB , BADGE_NO , DOJ , BASIC , DA , WAGE_EFFECTIVEDATE , ALLOWANCE , DOT , ROL , INACTIVE_DATE , PRESENT_STATEID , \
PRESENT_DISTRICT , PRESENT_TALUKA , PRESENT_VILLAGE , PERMANENT_STATEID , PERMANENT_DISTRICT , 	PERMANENT_TALUKA , \
PERMANENT_VILLAGE , MOBILE , SHOESIZE , NOOFCHILDREN , CONTRACTERCODE , PF , AADHAR , SURVEY_NO , RELATIONWITHSELLER , \
NAMEOFSELLER , VILLAGE , PAN , LABOR_ACC_EFF_DATE , OTHER_REASON_LEAVING , REALTIVE_NAME , MARITAL_STATUS , WIFE_NAME , \
HAZARD , PROFILE1 , PROFILE2 , PROFILE3 , PROFILE4 , TECHNICAL , ACADEMIC , CONTRACTOR_ID , PREV_EMPLOYER , REFERRED_BY , \
AMC_CHECKUP , BLOODGROUP , IS_RELATIVE_WIN , RELATIVE_ADDR , LANDLOSER , EXTENT , ACCTNO , BANKBRANCH , ACCTOPEN , MEDICAL , \
SKILLCERT , SAFETYCERT) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
#INSERT INTO CMSPERSONHISTORY VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)

business.cms.INSERT_CMSPERSONEFFDTHISTORY=\
INSERT INTO CMSPERSONEFFDTHISTORY (TRADE_ID,SKILL_ID, ETYPE,LTYPE, NOJEFFDT,EMP_ID)VALUES (?,?,?,?,?,?)
#INSERT INTO CMSPERSONEFFDTHISTORY VALUES (?,?,?,?,?,?,?)

business.cms.SELECT_ALL_CMSPERSONHISTORY=\
SELECT * from CMSPERSONHISTORY WHERE EMP_ID=?

business.cms.SELECT_PERSONDETL_BY_ID=\
SELECT PERSONDETLID \
      ,DOJ \
      ,DOT \
      ,PFANO \
      ,AADHARNO\
      ,GENDER\
      ,PANNO\
      ,HAZAREA\
      ,MARITAL\
      ,WIFENM\
      ,CHLDRNO\
      ,TECH\
      ,ACADS\
      ,PLIC1\
      ,PLIC2\
      ,PLIC3\
      ,PLIC4\
      ,PEMP\
      ,PCONTR\
      ,REFERREDBY\
      ,SHOESIZE\
      ,BLOODGRP\
      ,AMCDTM\
      ,WINCORELATIVE\
      ,WINCONAME\
      ,WINCOMADDRESSID\
      ,MOBILENO\
      ,LANDLOSER\
      ,SURVEYNO\
      ,RELWITHSLLR\
      ,VILLAGE\
      ,NAMEOFSELLER\
      ,EXTENT\
      ,ACTCONTRSW\
      ,BANKBRANCH\
      ,ACCTNO\
      ,MEDICALTRNSW\
      ,SAFETYTRNSW\
      ,SKILLCERTSW \
      ,EXPERIENCE \
      ,PREVOGRANIZATION \
	,INACTIVEDATE \
      ,REASONOFLEAVING \
,OTHERREASONOFLEAVING \
FROM CMSPERSONDETL WHERE PERSONDETLID=?
  
  
  #new ENTRY											 
																								   
business.cms.SELECT_contractorid= \
select coverage from CMSCONTRPEMM where UNITID=? and CONTRACTORID=?												  
					 
business.cms.SELECT_contractor_employees= \
select contractorid,count(*) as numberofemployees \
from CMSPERSON PS inner join vp_employeev42 VP on PS.EMPLOYEECODE=VP.PERSONNUM and UNITID=? AND \
contractorid=? and vp.EMPLOYMENTSTATUS='Active' \
group By contractorid

business.cms.SELECT_PERSONDTLID_BY_AADHAR_NUMBER= \
SELECT Persondetlid FROM CMSPERSONDETL WHERE aadharno=?
business.cms.INSERT_CMSWAGEHISTORY=\												   
exec dbo.SP_WAGEHISTORY_INSERT ?,?,?,?,?,?,?												   
# END
  
  
  
#merged
business.cms.SELECT_WORKMEN_BY_CONTID=\
SELECT EMPLOYEEID, EMPLOYEECODE, FIRSTNAME, LASTNAME, RELATIONNAME,\
DOB, IDMARK, TRADEID, SKILLID, PRESENTADDRID, PERMADDRID, PERSONDETLID,\
WAGEID, CONTRACTORID, STATUS, CP.PERSONID, ISLS, UNITID,ETYPE,LTYPE,NOJEFFDT  FROM CMSPERSON CP, VP_EMPLOYMENTSTAT VPE \
WHERE CONTRACTORID=? AND CP.PERSONID = VPE.PERSONID \
AND (VPE.EMPLOYMENTSTATUSDT < = sysdate \
AND VPE.EMPLOYMENTSTATUS=(SELECT SHORTNM FROM EMPLOYMENTSTAT WHERE EMPLOYMENTSTATID=?)) AND CP.UNITID = ?

# #merged $
business.cms.SELECT_WORKMEN_BY_CONTID_EMPCODE=\
SELECT EMPLOYEEID, EMPLOYEECODE, FIRSTNAME, LASTNAME, RELATIONNAME,\
DOB, IDMARK, TRADEID, SKILLID, PRESENTADDRID, PERMADDRID, PERSONDETLID,\
WAGEID, CONTRACTORID, STATUS, CP.PERSONID, ISLS, UNITID, ETYPE,LTYPE,NOJEFFDT  FROM CMSPERSON CP, VP_EMPLOYMENTSTAT VPE WHERE CP.CONTRACTORID = ? \
AND CP.EMPLOYEECODE=? \
AND CP.PERSONID = VPE.PERSONID \
AND (VPE.EMPLOYMENTSTATUSDT < = sysdate \
AND VPE.EMPLOYMENTSTATUS=(SELECT SHORTNM FROM EMPLOYMENTSTAT WHERE EMPLOYMENTSTATID=?)) AND CP.UNITID = ?

# #merged $
business.cms.SELECT_WORKMEN_BY_CONTID_EMPNAME=\
SELECT EMPLOYEEID, EMPLOYEECODE, FIRSTNAME, LASTNAME, RELATIONNAME,\
DOB, IDMARK, TRADEID, SKILLID, PRESENTADDRID, PERMADDRID, PERSONDETLID,\
WAGEID, CONTRACTORID, STATUS, CP.PERSONID, ISLS, UNITID , ETYPE,LTYPE,NOJEFFDT  FROM CMSPERSON CP, VP_EMPLOYMENTSTAT VPE WHERE CP.CONTRACTORID = ? \
AND (FIRSTNAME like ? or LASTNAME like ?) \
AND CP.PERSONID = VPE.PERSONID \
AND (VPE.EMPLOYMENTSTATUSDT < = sysdate \
AND VPE.EMPLOYMENTSTATUS=(SELECT SHORTNM FROM EMPLOYMENTSTAT WHERE EMPLOYMENTSTATID=?)) AND CP.UNITID = ?

# #merged $
business.cms.SELECT_WORKMEN_BY_CONTID_BY_TRADE_BY_SKILL=\
SELECT CP.EMPLOYEEID, EMPLOYEECODE, FIRSTNAME, LASTNAME, RELATIONNAME,DOB, IDMARK, TRADEID, SKILLID, \
PRESENTADDRID, PERMADDRID,PERSONDETLID,WAGEID,CONTRACTORID, STATUS, CP.PERSONID, ISLS, UNITID  ,ETYPE,LTYPE,NOJEFFDT \
FROM CMSPERSON CP INNER JOIN VP_EMPLOYEEV42 VPE ON CP.PERSONID=VPE.PERSONID WHERE CONTRACTORID = ? \
AND TRADEID=? AND  VPE.EMPLOYMENTSTATUS='Active' AND CP.UNITID = ?

business.cms.DELETE_WORKMEN=\
DELETE FROM CMSPERSON WHERE EMPLOYEEID=?

business.cms.DELETE_ADDRESS=\
DELETE FROM CMSADDRESS WHERE ADDRESSID=?

business.cms.DELETE_PERSONDETL=\
DELETE FROM CMSPERSONDETL WHERE PERSONDETLID=?

business.cms.DELETE_WAGE=\
DELETE FROM CMSWAGE WHERE WAGEID=?
#merged
business.cms.SELECT_WORKMEN_BY_ID=\
SELECT EMPLOYEEID, EMPLOYEECODE, FIRSTNAME, LASTNAME, RELATIONNAME,\
DOB, IDMARK, TRADEID, SKILLID, PRESENTADDRID, PERMADDRID,PERSONDETLID,\
WAGEID,CONTRACTORID, STATUS, PERSONID, ISLS, UNITID, ETYPE , LTYPE , NOJEFFDT from CMSPERSON where EMPLOYEEID = ?

business.cms.SELECT_STATES=\
select STATEID, STATENM from CMSSTATE

business.cms.SELECT_STATE_BY_ID=\
select STATEID, STATENM from CMSSTATE WHERE STATEID=?

business.cms.UPDATE_CMSADDRESS=\
UPDATE CMSADDRESS SET STREET=?, DISTRICT=?, TALUKA=?, VILLAGE=?, STATEID=? WHERE ADDRESSID=?


cms.business.UPDATE_TRADE=\
UPDATE TRADE SET TRADEID=?,NAME=?,DESCRIPTION=? WHERE TRADEID=?

business.cms.SELECT_TRADEID=\
select TRADEID, NAME, DESCRIPTION from CMSTRADE WHERE TRADEID = ?

business.cms.UPDATE_TRADE=\
UPDATE CMSTRADE SET NAME=?, DESCRIPTION=? WHERE TRADEID=?

business.cms.INSERT_TRADE=\
INSERT INTO CMSTRADE VALUES(?,?,?)

business.cms.SELECT_ALL_WORKORDERS=\
SELECT WORKORDERID \
      ,UNITID \
      ,CONTRACTORID \
      ,NAME \
      ,VALIDFROM \
      ,VALIDDT \
      ,TYPEID \
      ,DEPID \
      ,SECID \
      ,GLCODE \
      ,COSTCENTER \
      ,OWNERID \
      ,SUPRID \
      ,STATUS \
      , SAP_WORKORDER_NUM \
  FROM CMSWORKORDER
  
business.cms.SELECT_WORKORDERS_BY_DEPTID=\
SELECT WORKORDERID \
       ,UNITID \
      ,CONTRACTORID \
      ,NAME \
      ,VALIDFROM \
      ,VALIDDT \
      ,TYPEID \
      ,DEPID \
      ,SECID \
      ,GLCODE \
      ,COSTCENTER \
      ,OWNERID \
      ,SUPRID \
      ,STATUS \
      ,SAP_WORKORDER_NUM \
  FROM CMSWORKORDER WHERE DEPID=?
  
business.cms.SELECT_WORKORDERS=\
SELECT WORKORDERID \
	,UNITID \
      ,CONTRACTORID \
      ,CMSWORKORDER.NAME \
      ,VALIDFROM \
      ,VALIDDT \
      ,TYPEID \
      ,DEPID \
      ,CMSWORKORDER.SECID \
      ,GLCODE \
      ,COSTCENTER \
      ,OWNERID \
      ,SUPRID \
      ,STATUS \
      ,SAP_WORKORDER_NUM \
  FROM CMSWORKORDER, CMSSECTION WHERE CMSSECTION.NAME IN ({1}) AND STATUS in (?,?,?) AND UNITID=? AND CMSSECTION.SECID = CMSWORKORDER.SECID
  
business.cms.SELECT_WORKORDERS_BY_WKNUM_AC=\
SELECT WORKORDERID \
	,UNITID \
      ,CONTRACTORID \
      ,CMSWORKORDER.NAME \
      ,VALIDFROM \
      ,VALIDDT \
      ,TYPEID \
      ,DEPID \
      ,CMSWORKORDER.SECID \
      ,GLCODE \
      ,COSTCENTER \
      ,OWNERID \
      ,SUPRID \
      ,STATUS \
      ,SAP_WORKORDER_NUM \
  FROM CMSWORKORDER, CMSSECTION WHERE CMSSECTION.NAME IN ({1}) AND SAP_WORKORDER_NUM=? AND STATUS IN (?,?,?) AND UNITID=? \
  AND CMSSECTION.SECID = CMSWORKORDER.SECID
  
business.cms.SELECT_WORKORDERS_BY_SEC_AC=\
SELECT WORKORDERID \
	,UNITID \
      ,CONTRACTORID \
      ,CMSWORKORDER.NAME \
      ,VALIDFROM \
      ,VALIDDT \
      ,TYPEID \
      ,DEPID \
      ,CMSWORKORDER.SECID \
      ,GLCODE \
      ,COSTCENTER \
      ,OWNERID \
      ,SUPRID \
      ,STATUS \
      ,SAP_WORKORDER_NUM \
  FROM CMSWORKORDER, CMSSECTION WHERE CMSSECTION.NAME IN ({1}) AND STATUS IN (?,?,?) AND UNITID=? \
  AND CMSSECTION.SECID = CMSWORKORDER.SECID
  
  
business.cms.SELECT_WORKORDER_BY_ID=\
SELECT WORKORDERID \
	,UNITID \
      ,CONTRACTORID \
      ,NAME \
      ,VALIDFROM \
      ,VALIDDT \
      ,TYPEID \
      ,DEPID \
      ,SECID \
      ,GLCODE \
      ,COSTCENTER \
      ,OWNERID \
      ,SUPRID \
      ,STATUS \
      ,SAP_WORKORDER_NUM \
  FROM CMSWORKORDER WHERE WORKORDERID=?
  
  business.cms.UPDATE_WORKORDER=\
  UPDATE CMSWORKORDER SET DEPID=?, SECID=?, VALIDDT=? WHERE WORKORDERID=?
  
  business.cms.SELECT_WORKORDER_TYPES=\
  SELECT TYPEID, NAME, SAP_TYPE, SHORT_DESC, LONG_DESC  FROM CMSWORKORDERTYP
  
  business.cms.SELECT_SECTION_ID=\
  SELECT SECID, NAME, CODE,DESCRIPTION,DEPTID FROM CMSSECTION WHERE SECID=?
  
  business.cms.SELECT_WOA_BY_WOID=\
  SELECT ACTID, NAME, VALUE FROM CMSWORKORDERACT WHERE WORKORDERID=?
  
  business.cms.DELETE_ALL_WORKORDER_PROPERTIES=\
  DELETE FROM CMSWORKORDERACT WHERE WORKORDERID=?
  
  business.cms.INSERT_ALL_WORKORDER_PROPERTY=\
  INSERT INTO CMSWORKORDERACT VALUES(?,?,?,?)
  
  business.cms.SELECT_SUPR_BY_COID=\
  select SUPERVISORID, NAME, CONTRACTORID, UNITID, USERNAME, PASSWORD, EMAILADDR, MOBILENO from CMSSUPERVISORS \
  WHERE CONTRACTORID=?
  
  business.cms.SELECT_WKLINE_BY_WKID=\
  SELECT WORKORDERLNID, TRADEID, SKILLID, QTY, RATE, WORKORDERID, JOB, ITEM_NAME, DELIVERY_COMPLETED_SW, QTY_COMPLETED, DELETED_SW, CWL.SERVICECODE, \
  WBS_ELEMENT, UOM, ITEM_NUM,SERVICE_LN_ITEM_NUM FROM CMSWORKORDERLN CWL LEFT OUTER JOIN CMSSERVICEMASTER CSM \
  ON  CWL.SERVICEID = CSM.SERVICEID WHERE  WORKORDERID=?
  #SELECT WORKORDERLNID, TRADEID, SKILLID, QTY, RATE, WORKORDERID, JOB, ITEM_NAME, DELIVERY_COMPLETED_SW, QTY_COMPLETED, DELETED_SW, SERVICECODE, \
  #WBS_ELEMENT, UOM, ITEM_NUM,SERVICE_LN_ITEM_NUM FROM CMSWORKORDERLN LEFT OUTER JOIN CMSSERVICEMASTER \
  #ON  CMSWORKORDERLN.SERVICEID = CMSSERVICEMASTER.SERVICEID WHERE  WORKORDERID=?
   
  business.cms.SELECT_WKLINE_BY_WLID=\
  SELECT WORKORDERLNID, TRADEID, SKILLID, QTY, RATE, WORKORDERID, JOB, ITEM_NAME, DELIVERY_COMPLETED_SW, QTY_COMPLETED, DELETED_SW, CWL.SERVICECODE, \
  WBS_ELEMENT, UOM FROM CMSWORKORDERLN CWL LEFT OUTER JOIN CMSSERVICEMASTER CSM \
  ON  CWL.SERVICEID = CSM.SERVICEID WHERE  WORKORDERLNID=?
  #SELECT WORKORDERLNID, TRADEID, SKILLID, QTY, RATE, WORKORDERID, JOB, ITEM_NAME, DELIVERY_COMPLETED_SW, QTY_COMPLETED, DELETED_SW, SERVICECODE, \
  #WBS_ELEMENT, UOM FROM CMSWORKORDERLN LEFT OUTER JOIN CMSSERVICEMASTER \
  #ON  CMSWORKORDERLN.SERVICEID = CMSSERVICEMASTER.SERVICEID WHERE  WORKORDERLNID=?
  
  # MINIMUMWAGE
  
  business.cms.SELECT_BY_MINIMUMWAGEID=\
  select MINIMUMWAGEID,NAME,FRMDTM,TODTM,TRADEID,SKILLID,WAGEID,STATEID FROM CMSMINIMUMWAGE WHERE MINIMUMWAGEID=?
  
  business.cms.SELECT_BY_MINIMUMWAGENAME=\
  select MINIMUMWAGEID,NAME,FRMDTM,TODTM,TRADEID,SKILLID,WAGEID,STATEID FROM CMSMINIMUMWAGE WHERE NAME=?
  
  business.cms.SELECT_BY_MINIMUMWAGE=\
  select MINIMUMWAGEID,NAME,FRMDTM,TODTM,TRADEID,SKILLID,WAGEID,STATEID FROM CMSMINIMUMWAGE 
  
  cms.business.MWUpdate=\
  UPDATE CMSMINIMUMWAGE SET MINIMUMWAGEID=?,NAME=?,FRMDTM=?,TODTM=?,TRADEID=?,SKILLID=?,WAGEID=?,STATEID=? \
   WHERE MINIMUMWAGEID=?
   
   business.cms.SELECT_MW_STATE=\
   select MINIMUMWAGEID,NAME,FRMDTM,TODTM,TRADEID,SKILLID,WAGEID,CMSPESTATE.STATEID FROM CMSMINIMUMWAGE, CMSPESTATE  WHERE UNITID=? \
   AND FRMDTM <= ? AND TODTM >= ? 

  
  cms.business.MWSave= \
  INSERT INTO CMSMINIMUMWAGE VALUES(?,?,?,?,?,?,?,?)
  
  cms.business.MWUpdateExRecord=\
UPDATE CMSMINIMUMWAGE SET TODTM=? WHERE MINIMUMWAGEID=?

business.cms.SELECT_LRLINE_BY_WID=\
SELECT LRID,LRNUM,LRNAME,FROMDTM,TODTM,CMSLABORREQ.WORKORDERLNID,TRADEID, SKILLID FROM CMSLABORREQ, CMSWORKORDERLN, \
CMSSECTION, CMSWORKORDER \
WHERE CMSLABORREQ.WORKORDERLNID= CMSWORKORDERLN.WORKORDERLNID \
AND CMSWORKORDER.WORKORDERID = CMSWORKORDERLN.WORKORDERID \
AND CMSWORKORDER.SECID = CMSSECTION.SECID \
AND CMSWORKORDER.WORKORDERID=? AND FROMDTM >= ? \
AND TODTM <=? AND CMSSECTION.NAME IN ({1}) AND CMSSECTION.SECID = CMSWORKORDER.SECID

business.cms.SELECT_LRLINE_BY_WID_CCODE=\
SELECT LRID,LRNUM,LRNAME,FROMDTM,TODTM,CMSLABORREQ.WORKORDERLNID,TRADEID, SKILLID \
FROM CMSLABORREQ, CMSWORKORDERLN, CMSCONTRACTOR,CMSWORKORDER \
WHERE CMSLABORREQ.WORKORDERLNID= CMSWORKORDERLN.WORKORDERLNID \
AND CMSWORKORDER.WORKORDERID = CMSWORKORDERLN.WORKORDERID \
AND CMSWORKORDER.CONTRACTORID = CMSCONTRACTOR.CONTRACTORID \
AND CMSWORKORDER.WORKORDERID=? AND FROMDTM >= ? \
AND TODTM <=? AND CMSCONTRACTOR.CODE IN ({1}) 

business.cms.SELECT_LRLINE_CCODE=\
SELECT LRID,LRNUM,LRNAME,FROMDTM,TODTM,CMSLABORREQ.WORKORDERLNID,TRADEID, SKILLID, \
CMSWORKORDER.SAP_WORKORDER_NUM FROM CMSLABORREQ, CMSWORKORDERLN, CMSCONTRACTOR,CMSWORKORDER \
WHERE CMSLABORREQ.WORKORDERLNID= CMSWORKORDERLN.WORKORDERLNID \
AND CMSWORKORDER.WORKORDERID = CMSWORKORDERLN.WORKORDERID \
AND CMSWORKORDER.CONTRACTORID = CMSCONTRACTOR.CONTRACTORID \
AND CMSLABORREQ.APPROVALSW=? AND CMSWORKORDER.UNITID = ? \
AND CMSCONTRACTOR.CODE IN ({1}) 

business.cms.SELECT_LRLINE_BY_SECTIONS=\
SELECT LRID,LRNUM,LRNAME,FROMDTM,TODTM,CMSLABORREQ.WORKORDERLNID,TRADEID, SKILLID, \
CMSWORKORDER.SAP_WORKORDER_NUM FROM CMSLABORREQ, CMSWORKORDERLN, CMSSECTION, CMSWORKORDER \
WHERE CMSLABORREQ.WORKORDERLNID= CMSWORKORDERLN.WORKORDERLNID \
AND CMSWORKORDER.WORKORDERID = CMSWORKORDERLN.WORKORDERID \
AND CMSWORKORDER.SECID = CMSSECTION.SECID \
AND CMSWORKORDER.UNITID = ? \
AND CMSSECTION.NAME IN ({1}) 

business.cms.SELECT_LRLINE_BY_WOID=\
SELECT CMSLABORREQ.LRID,LRNUM,LRNAME,FROMDTM,TODTM,CMSLABORREQ.WORKORDERLNID, TRADEID, SKILLID FROM CMSLABORREQ, CMSWORKORDERLN \
WHERE WORKORDERID=? AND FROMDTM >= ? AND TODTM<= ? AND \
CMSWORKORDERLN.WORKORDERLNID =? AND CMSLABORREQ.WORKORDERLNID = CMSWORKORDERLN.WORKORDERLNID

business.cms.SELECT_LRLINE_BY_ID=\
SELECT LRID,LRNUM,LRNAME,FROMDTM,TODTM, WORKORDERLNID, TRADEID, SKILLID \
 FROM CMSLABORREQ WHERE LRID = ?

business.cms.SELECT_SHIFTS_BY_ID=\
SELECT SHIFTID, SHIFTNM, SHIFTIN, SHIFTOUT, PATTERNNAME, UNITID FROM CMSSHIFT WHERE UNITID=?

business.cms.SELECT_SHIFT_BY_ID=\
SELECT SHIFTID, SHIFTNM, SHIFTIN, SHIFTOUT, PATTERNNAME, UNITID FROM CMSSHIFT WHERE SHIFTID=?

business.cms.SELECT_SCHEDULES_BY_ID=\
SELECT SCHEDULEID, CMSPERSONID, TRADEID, SKILLID, PATTERNID, FROMDTM, TODTM, LRID, DELETEDSW, CREATEDDTM FROM CMSSCHEDULE WHERE LRID=?

business.cms.SELECT_SHIFT_PATTERN_BY_ID=\
select PATTERNNAME from CMSSHIFTPATTERN WHERE PATTERNID=?

business.cms.SELECT_WORKORDER_BY_LRID=\
SELECT CMSWORKORDER.WORKORDERID \
	,UNITID \
      ,CONTRACTORID \
      ,NAME \
      ,VALIDFROM \
      ,VALIDDT \
      ,TYPEID \
      ,DEPID \
      ,SECID \
      ,GLCODE \
      ,COSTCENTER \
      ,OWNERID \
      ,SUPRID \
      ,CMSWORKORDER.STATUS \
      ,SAP_WORKORDER_NUM \
  FROM CMSWORKORDER, CMSLABORREQ, CMSWORKORDERLN WHERE CMSLABORREQ.WORKORDERLNID = CMSWORKORDERLN.WORKORDERLNID AND \
  CMSWORKORDER.WORKORDERID= CMSWORKORDERLN.WORKORDERID AND LRID=?


  
business.cms.INSERT_LR = insert into CMSLABORREQ (LRNAME, LRNUM,FROMDTM,TODTM, WORKORDERLNID,TRADEID,SKILLID, LRID) \
values(?,?,?,?,?,?,?,?)

business.cms.UPDATE_LR = UPDATE CMSLABORREQ SET LRNAME =?, LRNUM=?,FROMDTM=?,TODTM=?, WORKORDERLNID =?, \
TRADEID=?, SKILLID=? WHERE LRID=?

business.cms.INSERT_SCHEDULE = \
INSERT INTO CMSSCHEDULE VALUES(?,?,?,?,?,?,?,?,?,?,?)

business.cms.SELECT_SCHEDULES_BY_ID_AND_TF=\
SELECT SCHEDULEID, CMSPERSONID, TRADEID, SKILLID, PATTERNID, FROMDTM, TODTM, LRID, DELETEDSW, CREATEDDTM FROM CMSSCHEDULE WHERE LRID=? \
AND FROMDTM = ? AND TODTM = ? order by createddtm desc

business.cms.SELECT_SHIFT_PATTERN_BY_NAME=\
select PATTERNID from CMSSHIFTPATTERN WHERE PATTERNNAME=?

business.cms.SELECT_SHIFT_PATTERN_BY_UNITID=\
select CMSSHIFTPATTERN.PATTERNNAME from CMSSHIFT, CMSSHIFTPATTERN WHERE CMSSHIFT.SHIFTID=CMSSHIFTPATTERN.SHIFTID AND  UNITID=?

business.cms.SELECT_SHIFT_BY_PATTERN_NAME=\
SELECT CMSSHIFT.SHIFTID, SHIFTNM, SHIFTIN, SHIFTOUT, CMSSHIFTPATTERN.PATTERNNAME, UNITID FROM CMSSHIFT, CMSSHIFTPATTERN WHERE \
CMSSHIFTPATTERN.PATTERNNAME=? AND CMSSHIFT.SHIFTID=CMSSHIFTPATTERN.SHIFTID


business.cms.SELECT_WORKORDER_BY_NUM=\
SELECT WORKORDERID \
	,UNITID \
      ,CONTRACTORID \
      ,NAME \
      ,VALIDFROM \
      ,VALIDDT \
      ,TYPEID \
      ,DEPID \
      ,SECID \
      ,GLCODE \
      ,COSTCENTER \
      ,OWNERID \
      ,SUPRID \
      ,STATUS \
      , SAP_WORKORDER_NUM \
  FROM CMSWORKORDER WHERE SAP_WORKORDER_NUM=?

business.cms.UPDATE_LR_APPROVAL=\
UPDATE CMSLABORREQ SET APPROVALSW =? WHERE LRID=?

business.cms.manager.approval=\
 select approvals.personid, count(*) Managers,   approvals.approvetype ApprovalType from  \
 (select m.PERSONID , m.MANAGERID, case when count(*) = (1 - datediff(day, ?, ?)) \
 then N'full' else N'partial' end approvetype from MGRAPPROVAL m where m.APPROVALDTM  \
 between ? and ? and m.personid in ({1}) group by m.personid, m.managerid ) approvals \
 group by approvals.personid,  approvals.approvetype order by approvals.personid 
 
 business.cms.exceptions=\
 select j.personId from WFCException, TimeSheetItem, JAIDS j where TimeSheetItem.TIMESHEETITEMID = WFCException.TIMESHEETITEMID \
 and WFCException.EXCEPTIONTYPEID IN (SELECT EXCEPTIONTYPEID FROM EXCEPTIONTYPE) and TimeSheetItem.EMPLOYEEID  = j.employeeId \
 and j.personId in ({1}) and TimeSheetItem.EVENTDTM  between ? and ?
 
 business.cms.unapproved=\
 select distinct j.personid from WFCTOTAL wt, TIMESHEETITEM ts, JAIDS j, workrule w where wt.timesheetitemid = ts.timesheetitemid \
 and j.employeeid = wt.employeeID and ts.workruleid = w.workruleid and wt.paycodeid = w.unapprovedpcid and wt.APPLYDTM >= w.effectivedtm \
 and wt.APPLYDTM < w.expirationdtm and j.personid in ({1}) and wt.APPLYDTM between ? and ? group by j.personid
 
 
 # Current pay period
 business.cms.SummaryViewSqlStringConstant.GET_WORKORDERS_CURRENT_PAY_PERIOD=\
 select Distinct j.personid, w.SAP_WORKORDER_NUM \
 from JAIDS j, CMSWORKORDER w , CMSLABORREQ lq, CMSWORKORDERLN ln, CMSSCHEDULE cs,CMSPERSON P \
 where j.EMPLOYEEID = p.PERSONID \
 and p.PERSONID = cs.CMSPERSONID \
 and cs.LRID = lq.LRID \
 and lq.WORKORDERLNID = ln.WORKORDERLNID \
 and ln.WORKORDERID = w.WORKORDERID \
 and j.personid in ({1}) \
 and cs.FROMDTM <= J.CPENDDATEDTM \
 and cs.TODTM > J.CPENDDATEDTM \
 order by j.personid
 
 
 #Previous Pay Period
 business.cms.SummaryViewSqlStringConstant.GET_WORKORDERS_PREVIOUS_PAY_PERIOD=\
 select Distinct j.personid, w.SAP_WORKORDER_NUM \
 from JAIDS j, CMSWORKORDER w , CMSLABORREQ lq, CMSWORKORDERLN ln, CMSSCHEDULE cs,CMSPERSON P \
 where j.PERSONID = p.PERSONID \
 and p.EMPLOYEEID = cs.CMSPERSONID \
 and cs.LRID = lq.LRID \
 and lq.WORKORDERLNID = ln.WORKORDERLNID \
 and ln.WORKORDERID = w.WORKORDERID \
 and j.personid in ({1}) \
 and cs.FROMDTM <= J.PPENDDATEDTM \
 and cs.TODTM > J.PPENDDATEDTM \
 order by j.personid
  
 #Next pay period
 business.cms.SummaryViewSqlStringConstant.GET_WORKORDERS_NEXT_PAY_PERIOD=\
 select Distinct j.personid, w.SAP_WORKORDER_NUM \
 from JAIDS j, CMSWORKORDER w , CMSLABORREQ lq, CMSWORKORDERLN ln, CMSSCHEDULE cs,CMSPERSON P \
 where j.PERSONID = p.PERSONID \
 and p.EMPLOYEEID = cs.CMSPERSONID \
 and cs.LRID = lq.LRID \
 and lq.WORKORDERLNID = ln.WORKORDERLNID \
 and ln.WORKORDERID = w.WORKORDERID \
 and j.personid in ({1}) \
 and cs.FROMDTM <= J.NPENDDATEDTM \
 and cs.TODTM > J.NPENDDATEDTM \
 order by j.personid

 business.cms.SummaryViewSqlStringConstant.GET_WORKORDERS_DATE_RANGE=\
 select Distinct j.personid, w.SAP_WORKORDER_NUM \
 from JAIDS j, CMSWORKORDER w , CMSLABORREQ lq, CMSWORKORDERLN ln, CMSSCHEDULE cs,CMSPERSON P \
 where j.PERSONID = p.PERSONID \
 and p.EMPLOYEEID = cs.CMSPERSONID \
 and cs.LRID = lq.LRID \
 and lq.WORKORDERLNID = ln.WORKORDERLNID \
 and ln.WORKORDERID = w.WORKORDERID \
 and j.personid in ({1}) \
 and cs.FROMDTM <= ? \
 and cs.TODTM > ? \
 order by j.personid
 
 business.cms.SummaryViewSqlStringConstant.TRADE=\
 select Distinct j.personid, NAME \
 from JAIDS j, CMSPERSON P, CMSTRADE tr \
 where j.PERSONID = p.PERSONID \
 and p.TRADEID = tr.TRADEID \
 and j.personid in ({1}) \
 order by j.personid
 
 business.cms.SummaryViewSqlStringConstant.SKILL=\
 select Distinct j.personid, SKILLNM \
 from JAIDS j, CMSPERSON P, CMSSKILL sk \
 where j.PERSONID = p.PERSONID \
 and p.SKILLID = sk.SKILLID \
 and j.personid in ({1}) \
 order by j.personid
 
 business.cms.SummaryViewSqlStringConstant.CONTRACTORNAME=\
 select Distinct j.personid, NAME \
  from JAIDS j, CMSPERSON P, CMSCONTRACTOR contr \
  where j.PERSONID = p.PERSONID \
  and p.CONTRACTORID = contr.CONTRACTORID \
  and j.personid in ({1}) \
 order by j.personid
 
 business.cms.SummaryViewSqlStringConstant.WORKMENWAGE=\
select Distinct j.personid, wg.BASIC, wg.DA, wg.ALLOWANCE \
  from JAIDS j, CMSPERSON P, CMSWAGE wg \
  where j.PERSONID = p.PERSONID \
  and p.WAGEID =  wg.WAGEID \
  and j.personid in ({1}) \
  order by j.personid 
 
 cms.business.SELECT_RATE=\
 select RATE from CMSWORKORDERLN ln , CMSWORKORDER wk, CMSWORKORDERTYP typ \
 where ln.WORKORDERID = wk.WORKORDERID and wk.TYPEID = typ.TYPEID and typ.NAME = 'A' \
 and wk.SAP_WORKORDER_NUM = ? \
 and ln.SERVICEID in (select sm.serviceid from cmsservicemaster sm, cmsperson p, JAIDS j where \
 sm.tradeid = p.tradeid and sm.skillid = p.skillid and j.PERSONID =  p.PERSONID \
 and j.personid = ? )
 
 business.cms.SummaryViewSqlStringConstant.MINIMUMWAGE_CURRENT_PAY_PERIOD=\
select Distinct j.personid, wg.BASIC, wg.DA, wg.ALLOWANCE \
  from JAIDS j, CMSPERSON P, CMSWAGE wg, CMSMINIMUMWAGE mg \
  where j.PERSONID = p.PERSONID \
  and p.TRADEID =  mg.TRADEID \
  and p.SKILLID =mg.SKILLID  \
  and mg.WAGEID = wg.WAGEID  \
  and mg.FRMDTM <= J.CPENDDATEDTM \
  and mg.TODTM > J.CPSTARTDATEDTM \
  and j.personid in ({1})  \
  order by j.personid  
  
  business.cms.SummaryViewSqlStringConstant.MINIMUMWAGE_PREVIOUS_PAY_PERIOD=\
select Distinct j.personid, wg.BASIC, wg.DA, wg.ALLOWANCE \
  from JAIDS j, CMSPERSON P, CMSWAGE wg, CMSMINIMUMWAGE mg \
  where j.PERSONID = p.PERSONID \
  and p.TRADEID =  mg.TRADEID \
  and p.SKILLID =mg.SKILLID  \
  and mg.WAGEID = wg.WAGEID  \
  and mg.FRMDTM <= J.PPENDDATEDTM \
  and mg.TODTM > J.PPSTARTDATEDTM \
  and j.personid in ({1})  \
  order by j.personid  
 
 business.cms.SummaryViewSqlStringConstant.MINIMUMWAGE_NEXT_PAY_PERIOD=\
select Distinct j.personid, wg.BASIC, wg.DA, wg.ALLOWANCE \
  from JAIDS j, CMSPERSON P, CMSWAGE wg, CMSMINIMUMWAGE mg \
  where j.PERSONID = p.PERSONID \
  and p.TRADEID =  mg.TRADEID \
  and p.SKILLID =mg.SKILLID  \
  and mg.WAGEID = wg.WAGEID  \
  and mg.FRMDTM <= J.NPENDDATEDTM  \
  and mg.TODTM > J.NPSTARTDATEDTM  \
  and j.personid in ({1})  \
  order by j.personid  
 
 business.cms.SummaryViewSqlStringConstant.MINIMUMWAGE_DATE_RANGE=\
select Distinct j.personid, wg.BASIC, wg.DA, wg.ALLOWANCE \
  from JAIDS j, CMSPERSON P, CMSWAGE wg, CMSMINIMUMWAGE mg \
  where j.PERSONID = p.PERSONID \
  and p.TRADEID =  mg.TRADEID \
  and p.SKILLID = mg.SKILLID  \
  and mg.WAGEID = wg.WAGEID  \
  and j.personid in ({1})  \
  and mg.FRMDTM <= ?  \
  and mg.TODTM > ?  \
  order by j.personid  
 

 business.cms.SELECT_LRSHIFT_BY_LRID=\
 select LRID, SHIFTID,QTY FROM CMSLRSHIFT1M WHERE LRID=?

business.cms.UPDATE_LRSHIFT=\
UPDATE CMSLRSHIFT1M SET QTY=? WHERE LRID=? AND SHIFTID=?

business.cms.INSERT_LRSHIFT=\
INSERT INTO CMSLRSHIFT1M (LRID,SHIFTID,QTY) VALUES(?,?,?)

business.cms.SELECT_MANAGERS_BY_SECID=\
SELECT MANAGERID, CMSMANAGERS.NAME, CMSMANAGERS.DEPID, SECID, USERNAME, PASSWORD, EMAILADDR, MOBILENO, ISDEPTMGR, PERSONID \
FROM CMSMANAGERS, CMSDEPT WHERE cmsmanagers.DEPID = CMSDEPT.DEPID and SECID = ? AND UNITID = ? ORDER BY MANAGERID DESC

business.cms.SELECT_SUPR_BY_ID=\
select SUPERVISORID, NAME, CONTRACTORID, UNITID, USERNAME, PASSWORD, EMAILADDR, MOBILENO from CMSSUPERVISORS \
  WHERE SUPERVISORID=?
  
business.cms.UPDATE_LR_PAGE_APPROVAL=\
UPDATE CMSLABORREQPAGE SET APPROVALSW =? WHERE LRPAGEID=?  

business.cms.SELECT_LRPAGE_BY_ID=\
SELECT LRPAGEID, LRPAGENUM, FROMDTM, TODTM, APPROVALSW, WORKORDERID, DELETESW, REMARK,CREATEDONDTM, \
UPDATEDDTM, UPDATEDBY, WEEKLYOFFDAYS  FROM CMSLABORREQPAGE WHERE LRPAGEID=?

business.cms.SELECT_LRS_BY_PAGEID=\
SELECT LRPAGEID, LRID FROM CMSLRPAGELR1M WHERE LRPAGEID=?

business.cms.SELECT_WORKORDER_BY_PAGEID=\
SELECT CMSWORKORDER.WORKORDERID \
	,UNITID \
      ,CONTRACTORID \
      ,NAME \
      ,VALIDFROM \
      ,VALIDDT \
      ,TYPEID \
      ,DEPID \
      ,SECID \
      ,GLCODE \
      ,COSTCENTER \
      ,OWNERID \
      ,SUPRID \
      ,CMSWORKORDER.STATUS \
      ,SAP_WORKORDER_NUM \
  FROM CMSWORKORDER, CMSLABORREQPAGE WHERE  \
  CMSWORKORDER.WORKORDERID= CMSLABORREQPAGE.WORKORDERID AND LRPAGEID=?
  
  business.cms.INSERT_LR_PAGE=\
  INSERT INTO CMSLABORREQPAGE (LRPAGENUM, FROMDTM, TODTM, APPROVALSW, WORKORDERID, REMARK, CREATEDONDTM, UPDATEDDTM, UPDATEDBY, WEEKLYOFFDAYS, LRPAGEID) VALUES(?,?,?,?,?,?,?,?,?,?,?)
  
  business.cms.INSERT_LR_PAGE_MM=\
  INSERT INTO CMSLRPAGELR1M(LRPAGEID,LRID) VALUES(?,?)
  
  business.cms.UPDATE_LR_PAGE=\
  UPDATE CMSLABORREQPAGE SET LRPAGENUM=?, FROMDTM=?, TODTM=?, APPROVALSW=?, WORKORDERID=?, REMARK=?, UPDATEDDTM=?, UPDATEDBY=?, WEEKLYOFFDAYS=? WHERE LRPAGEID=?
  
  business.cms.DELETE_LR_PAGE_MM=\
  DELETE FROM CMSLRPAGELR1M WHERE LRPAGEID=?
  
  business.cms.SELECT_LRPAGE_BY_WID_CCODE=\
  SELECT LRPAGEID,LRPAGENUM,FROMDTM,TODTM,APPROVALSW, CMSLABORREQPAGE.WORKORDERID,DELETESW, REMARK, \
  CREATEDONDTM, UPDATEDDTM, UPDATEDBY, WEEKLYOFFDAYS FROM CMSLABORREQPAGE, CMSCONTRACTOR,CMSWORKORDER \
  WHERE CMSLABORREQPAGE.WORKORDERID= CMSWORKORDER.WORKORDERID \
  AND CMSWORKORDER.CONTRACTORID = CMSCONTRACTOR.CONTRACTORID \
  AND CMSWORKORDER.WORKORDERID=? AND FROMDTM >= ? \
  AND TODTM <=? AND APPROVALSW = ? 
  
  business.cms.SELECT_LRPAGE_BY_WID_CCODE_1=\
    SELECT LRPAGEID,LRPAGENUM,FROMDTM,TODTM,APPROVALSW, CMSLABORREQPAGE.WORKORDERID,DELETESW, REMARK, \
    CREATEDONDTM, UPDATEDDTM, UPDATEDBY, WEEKLYOFFDAYS FROM CMSLABORREQPAGE, CMSCONTRACTOR,CMSWORKORDER \
    WHERE CMSLABORREQPAGE.WORKORDERID= CMSWORKORDER.WORKORDERID \
    AND CMSWORKORDER.CONTRACTORID = CMSCONTRACTOR.CONTRACTORID \
    AND CMSWORKORDER.WORKORDERID=? AND FROMDTM >= ? \
  AND TODTM <=? AND APPROVALSW = ? and ( CMSCONTRACTOR.CODE IN ({1}))
  
business.cms.SELECT_LRPAGE_BY_UNITID_CCODE=\
SELECT LRPAGEID,LRPAGENUM,FROMDTM,TODTM,APPROVALSW, CMSLABORREQPAGE.WORKORDERID,DELETESW, REMARK, \
CREATEDONDTM, UPDATEDDTM, UPDATEDBY, WEEKLYOFFDAYS FROM CMSLABORREQPAGE, CMSCONTRACTOR,CMSWORKORDER \
WHERE CMSLABORREQPAGE.WORKORDERID= CMSWORKORDER.WORKORDERID \
AND CMSWORKORDER.CONTRACTORID = CMSCONTRACTOR.CONTRACTORID \
AND CMSLABORREQPAGE.APPROVALSW=? AND CMSWORKORDER.UNITID = ? 
 
business.cms.SELECT_LRPAGE_BY_UNITID_CCODE_1=\
SELECT LRPAGEID,LRPAGENUM,FROMDTM,TODTM,APPROVALSW, CMSLABORREQPAGE.WORKORDERID,DELETESW, REMARK, \
CREATEDONDTM, UPDATEDDTM, UPDATEDBY, WEEKLYOFFDAYS FROM CMSLABORREQPAGE, CMSCONTRACTOR,CMSWORKORDER \
WHERE CMSLABORREQPAGE.WORKORDERID= CMSWORKORDER.WORKORDERID \
AND CMSWORKORDER.CONTRACTORID = CMSCONTRACTOR.CONTRACTORID \
AND CMSLABORREQPAGE.APPROVALSW=? AND CMSWORKORDER.UNITID = ? and ( CMSCONTRACTOR.CODE IN ({1}))

business.cms.SELECT_LRPAGE_BY_SECTIONS=\
SELECT LRPAGEID,LRPAGENUM,FROMDTM,TODTM,APPROVALSW, CMSLABORREQPAGE.WORKORDERID,DELETESW, REMARK, \
CREATEDONDTM, UPDATEDDTM, UPDATEDBY, WEEKLYOFFDAYS FROM CMSLABORREQPAGE, CMSSECTION, CMSWORKORDER \
WHERE CMSLABORREQPAGE.WORKORDERID= CMSWORKORDER.WORKORDERID \
AND CMSWORKORDER.SECID = CMSSECTION.SECID \
AND CMSWORKORDER.UNITID = ? and CMSLABORREQPAGE.APPROVALSW = ? \
AND CMSSECTION.NAME IN ({1})  order by approvalSW desc

business.cms.SELECT_LRPAGES_BY_WID=\
  SELECT LRPAGEID,LRPAGENUM,FROMDTM,TODTM,APPROVALSW, CMSLABORREQPAGE.WORKORDERID,DELETESW, REMARK, \
  CREATEDONDTM, UPDATEDDTM, UPDATEDBY,WEEKLYOFFDAYS FROM CMSLABORREQPAGE, CMSCONTRACTOR,CMSWORKORDER \
  WHERE CMSLABORREQPAGE.WORKORDERID= CMSWORKORDER.WORKORDERID \
  AND CMSWORKORDER.CONTRACTORID = CMSCONTRACTOR.CONTRACTORID \
  AND CMSWORKORDER.WORKORDERID=?
  
  business.cms.SELECT_LRPAGE_BY_WID_SECTIONS=\
SELECT LRPAGEID,LRPAGENUM,FROMDTM,TODTM,APPROVALSW, CMSLABORREQPAGE.WORKORDERID,DELETESW, REMARK, \
CREATEDONDTM, UPDATEDDTM, UPDATEDBY, WEEKLYOFFDAYS FROM CMSLABORREQPAGE, CMSSECTION, CMSWORKORDER \
WHERE CMSLABORREQPAGE.WORKORDERID= CMSWORKORDER.WORKORDERID \
AND CMSWORKORDER.SECID = CMSSECTION.SECID \
AND CMSWORKORDER.WORKORDERID = ? \
AND FROMDTM >= ? \
AND TODTM <=? AND APPROVALSW=? AND CMSSECTION.NAME IN ({1}) order by approvalSW desc 

business.cms.SELECT_LRPAGE_BY_WID_SECTIONS_1=\
SELECT LRPAGEID,LRPAGENUM,FROMDTM,TODTM,APPROVALSW, CMSLABORREQPAGE.WORKORDERID,DELETESW, REMARK, \
CREATEDONDTM, UPDATEDDTM, UPDATEDBY, WEEKLYOFFDAYS FROM CMSLABORREQPAGE, CMSSECTION, CMSWORKORDER \
WHERE CMSLABORREQPAGE.WORKORDERID= CMSWORKORDER.WORKORDERID \
AND CMSWORKORDER.SECID = CMSSECTION.SECID \
AND CMSWORKORDER.WORKORDERID = ? \
AND FROMDTM >= ? \
AND TODTM <=? AND APPROVALSW=? AND CMSSECTION.NAME=? AND CMSSECTION.NAME IN ({1}) order by approvalSW desc 

  
business.cms.SELECT_ACTUAL_ATTENDANCE_BY_WORKORDER=\
SELECT tradeid, skillid, wt.laboracctid, paycode1mmflat.grandpaycodeid,  \
sum(wt.durationsecsqty) AmountInHrs \
 FROM wfctotal wt, laboracct la, JAIDS j, Person P ,paycode1mmflat, cmsperson \
 WHERE j.employeeid = wt.employeeid and p.personid = j.employeeid and wt.employeeid= j.employeeid  \
 and wt.laboracctid = la.laboracctid  \
 and paycode1mmflat.grandpaycodeid in (select PAYCODEID from cmspaycodedef where typenm = 'R' and UNITID=? ) \
 and wt.paycodeid = paycode1mmflat.paycodeid \
 and paycode1mmflat.effectivedtm <=  wt.applydtm and paycode1mmflat.expirationdtm > wt.applydtm \
 and wt.laboracctid in (select laboracctid from laboracct where LABORLEV6NM=?) \
 and wt.NOTPAIDSW = 0 \
 and wt.APPLYDTM < ? \
 and tradeid=? \
 and skillid=? \
 and cmsperson.personid = j.personid \
GROUP BY tradeid, skillid, wt.laboracctid, paycode1mmflat.grandpaycodeid 

business.cms.SELECT_FUTURE_BALANCE_BY_WlID=\
SELECT CMSLABORREQ.LRID,LRNUM,LRNAME,CMSLABORREQ.FROMDTM,CMSLABORREQ.TODTM,CMSLABORREQ.WORKORDERLNID,TRADEID, SKILLID \
FROM CMSLABORREQ, CMSWORKORDERLN, CMSLABORREQPAGE, CMSLRPAGELR1M \
WHERE CMSLABORREQ.WORKORDERLNID= CMSWORKORDERLN.WORKORDERLNID \
AND CMSWORKORDERLN.WORKORDERLNID=? \
AND CMSLRPAGELR1M.LRID = CMSLABORREQ.LRID \
AND CMSLABORREQPAGE.LRPAGEID= CMSLRPAGELR1M.LRPAGEID \
AND CMSLABORREQPAGE.APPROVALSW IN (0,1) \
AND CMSLABORREQ.TODTM > ? 

business.cms.delete.lrshifts=\
DELETE FROM CMSLRSHIFT1M WHERE LRID = ?

business.cms.delete.lr=\
DELETE FROM CMSLABORREQ WHERE LRID =?

business.cms.DELETE_CMSLRPAGELR1M=\
DELETE FROM CMSLRPAGELR1M WHERE LRPAGEID = ?

business.cms.DELETE_CMSLRPAGE=\
dELETE FROM CMSLABORREQPAGE WHERE LRPAGEID = ?

business.cms.SELECT_LRPAGES_BY_WID_DATES=\
SELECT LRPAGEID,LRPAGENUM,FROMDTM,TODTM,APPROVALSW, CMSLABORREQPAGE.WORKORDERID,DELETESW, REMARK, \
  CREATEDONDTM, UPDATEDDTM, UPDATEDBY,WEEKLYOFFDAYS FROM CMSLABORREQPAGE, CMSCONTRACTOR,CMSWORKORDER \
  WHERE CMSLABORREQPAGE.WORKORDERID= CMSWORKORDER.WORKORDERID \
  AND CMSWORKORDER.CONTRACTORID = CMSCONTRACTOR.CONTRACTORID \
  AND CMSWORKORDER.WORKORDERID=? AND FROMDTM=? AND TODTM=?
  
  business.cms.SELECT_LRPAGE_BY_DATE_SECTIONS_CODE=\
  SELECT LRPAGEID,LRPAGENUM,FROMDTM,TODTM,APPROVALSW, CMSLABORREQPAGE.WORKORDERID,DELETESW, REMARK, \
  CREATEDONDTM, UPDATEDDTM, UPDATEDBY, WEEKLYOFFDAYS FROM CMSLABORREQPAGE, CMSSECTION, CMSWORKORDER \
  WHERE CMSLABORREQPAGE.WORKORDERID= CMSWORKORDER.WORKORDERID \
  AND CMSWORKORDER.SECID = CMSSECTION.SECID \
  AND CMSWORKORDER.UNITID = ? \
  AND FROMDTM >= ? \
  AND TODTM <=? AND APPROVALSW=? AND CMSSECTION.NAME=? AND CMSSECTION.NAME IN ({1}) 
  
  business.cms.SELECT_LRPAGE_BY_DATE_SECTIONS=\
    SELECT LRPAGEID,LRPAGENUM,FROMDTM,TODTM,APPROVALSW, CMSLABORREQPAGE.WORKORDERID,DELETESW, REMARK, \
    CREATEDONDTM, UPDATEDDTM, UPDATEDBY, WEEKLYOFFDAYS FROM CMSLABORREQPAGE, CMSSECTION, CMSWORKORDER \
    WHERE CMSLABORREQPAGE.WORKORDERID= CMSWORKORDER.WORKORDERID \
    AND CMSWORKORDER.SECID = CMSSECTION.SECID \
    AND CMSWORKORDER.UNITID = ? \
    AND FROMDTM >= ? \
    AND TODTM <=? AND APPROVALSW=? AND CMSSECTION.NAME IN ({1}) 
  
  business.cms.SELECT_LRPAGE_BY_WID_SECTIONS_2=\
  SELECT LRPAGEID,LRPAGENUM,FROMDTM,TODTM,APPROVALSW, CMSLABORREQPAGE.WORKORDERID,DELETESW, REMARK, \
    CREATEDONDTM, UPDATEDDTM, UPDATEDBY, WEEKLYOFFDAYS FROM CMSLABORREQPAGE, CMSSECTION, CMSWORKORDER \
    WHERE CMSLABORREQPAGE.WORKORDERID= CMSWORKORDER.WORKORDERID \
    AND CMSWORKORDER.SECID = CMSSECTION.SECID \
    AND CMSWORKORDER.WORKORDERID = ? AND APPROVALSW=? \
    AND CMSSECTION.NAME IN ({1}) 
    
    business.cms.SELECT_LRPAGE_BY_WID_SECTIONS_2_CODE=\
  SELECT LRPAGEID,LRPAGENUM,FROMDTM,TODTM,APPROVALSW, CMSLABORREQPAGE.WORKORDERID,DELETESW, REMARK, \
    CREATEDONDTM, UPDATEDDTM, UPDATEDBY, WEEKLYOFFDAYS FROM CMSLABORREQPAGE, CMSSECTION, CMSWORKORDER \
    WHERE CMSLABORREQPAGE.WORKORDERID= CMSWORKORDER.WORKORDERID \
    AND CMSWORKORDER.SECID = CMSSECTION.SECID \
    AND CMSWORKORDER.WORKORDERID = ? AND APPROVALSW=? \
    AND CMSSECTION.NAME = ? AND CMSSECTION.NAME IN ({1}) 
    
business.cms.SELECT_LRPAGE_BY_WID_SECTIONS_2_CODE_1=\
  SELECT LRPAGEID,LRPAGENUM,FROMDTM,TODTM,APPROVALSW, CMSLABORREQPAGE.WORKORDERID,DELETESW, REMARK, \
    CREATEDONDTM, UPDATEDDTM, UPDATEDBY, WEEKLYOFFDAYS FROM CMSLABORREQPAGE, CMSSECTION, CMSWORKORDER \
    WHERE CMSLABORREQPAGE.WORKORDERID= CMSWORKORDER.WORKORDERID \
    AND CMSWORKORDER.SECID = CMSSECTION.SECID \
    AND APPROVALSW=? \
    AND CMSSECTION.NAME = ? AND CMSSECTION.NAME IN ({1}) 


business.cms.SELECT_SECTIONS=\
SELECT SECID, NAME, CODE,DESCRIPTION,DEPTID FROM CMSSECTION order by NAME

business.cms.SELECT_DEPTS=\
SELECT DEPID, NAME, DESCRIPTION,UNITID FROM CMSDEPT order by NAME

business.cms.SELECT_SCHEDULE_QUANTITY_TRADE_SKILL_TF=\
select sum(24 * (sg.ENDDTM - sg.STARTDTM)), TRADEID, SKILLID from SHIFTASSIGNMNT sa, SHIFTSEGMENT sg, CMSPERSON p \
where sa.deletedsw = 0 and sa.EMPLOYEEID = p.PERSONID  \
and p.tradeid =? and p.skillid =? and sa.SHIFTSTARTDATE >= ? \
and sa.SHIFTENDDATE <=? \
and sg.SHIFTCODEID = sa.SHIFTCODEID and sg.LABORACCTID in (select laboracctid from laboracct where LABORLEV6NM=?) \
group by TRADEID, SKILLID

business.cms.SELECT_SCHEDULE_QUANTITY_TF_PER_PERSON=\
select p.personid, sum(24 * (sg.ENDDTM - sg.STARTDTM)),sa.SHIFTSTARTDATE, sa.SHIFTENDDATE from SHIFTASSIGNMNT sa, \
SHIFTSEGMENT sg, CMSPERSON p \
where sa.deletedsw = 0 and sa.EMPLOYEEID = p.PERSONID  \
and p.tradeid =? and p.skillid =? and sa.SHIFTSTARTDATE >= ?  \
and sa.SHIFTENDDATE <=? \
and sg.SHIFTCODEID = sa.SHIFTCODEID and sg.LABORACCTID in (select laboracctid from laboracct where LABORLEV6NM=?) \
group by p.personid, sa.SHIFTSTARTDATE, sa.SHIFTENDDATE order by sa.SHIFTSTARTDATE

business.cms.SELECT_SCHEDULE_QUANTITY_TF_PER_WK=\
select count(p.personid), sa.SHIFTSTARTDATE from SHIFTASSIGNMNT sa, \
SHIFTSEGMENT sg, CMSPERSON p \
where sa.deletedsw = 0 and sa.EMPLOYEEID = p.PERSONID  \
AND CAST( SA.SHIFTSTARTDATE AS DATE) BETWEEN  CAST (? AS DATE) AND CAST( ? AS DATE) \
and sg.SHIFTCODEID = sa.SHIFTCODEID and sg.LABORACCTID in (select laboracctid from laboracct where LABORLEV6NM=?) \
group by sa.SHIFTSTARTDATE order by sa.SHIFTSTARTDATE


business.cms.SELECT_SHIFT_BY_START_DATE=\
SELECT CMSSHIFT.SHIFTID, SHIFTNM, SHIFTIN, SHIFTOUT, PATTERNNAME, UNITID FROM CMSSHIFT, CMSSHIFTSTARTDATE  \
WHERE  CMSSHIFTSTARTDATE.SHIFTID = CMSSHIFT.SHIFTID AND CMSSHIFTSTARTDATE.SHIFTSTARTDTM = ? \
AND CMSSHIFTSTARTDATE.SHIFTENDDTM = ? AND CMSSHIFT.UNITID =?
 
 business.cms.SELECT_APPROVED_LRLINE_BY_WID_TF=\
 SELECT CMSLABORREQ.LRID,LRNUM,LRNAME, CMSLABORREQ.FROMDTM,CMSLABORREQ.TODTM, WORKORDERLNID,TRADEID, SKILLID, \
 CMSWORKORDER.SAP_WORKORDER_NUM FROM CMSLABORREQ, CMSLABORREQPAGE, CMSLRPAGELR1M, CMSWORKORDER  \
 WHERE CMSWORKORDER.WORKORDERID = CMSLABORREQPAGE.WORKORDERID  \
 AND CMSLRPAGELR1M.LRPAGEID = CMSLABORREQPAGE.LRPAGEID \
 AND CMSLRPAGELR1M.LRID = CMSLABORREQ.LRID \
 AND CMSLABORREQPAGE.APPROVALSW=1  \
 AND CMSLABORREQPAGE.FROMDTM <= ? AND CMSLABORREQPAGE.TODTM >= ? \
 AND CMSLABORREQ.TRADEID = ? AND CMSLABORREQ.SKILLID = ? \
 AND CMSWORKORDER.WORKORDERID = ? 
 
 business.cms.SELECT_SCHEDULE_TF_PER_PERSON=\
select p.personid, sum(24 * (sg.ENDDTM - sg.STARTDTM)),sa.SHIFTSTARTDATE, sa.SHIFTENDDATE from SHIFTASSIGNMNT sa, \
SHIFTSEGMENT sg, CMSPERSON p \
where sa.deletedsw = 0 and sa.EMPLOYEEID = p.PERSONID  \
and p.tradeid =? and p.skillid =? and sa.SHIFTSTARTDATE >= ?  \
and sa.SHIFTENDDATE <=? \
and p.CONTRACTORID=? \
and sg.SHIFTCODEID = sa.SHIFTCODEID  \
group by p.personid, sa.SHIFTSTARTDATE, sa.SHIFTENDDATE order by sa.SHIFTSTARTDATE

business.cms.active.workmen=\
select COUNT(*) from JAIDS where exists ( select * from PERSONSTATUSMM where PERSONSTATUSMM.EMPLOYMENTSTATID = 1 \
and PERSONSTATUSMM.EFFECTIVEDTM <= ? \
and PERSONSTATUSMM.EXPIRATIONDTM > ? \
and PERSONSTATUSMM.PERSONID = JAIDS.PERSONID) \
and exists (select * from CMSPERSON where cmsperson.CONTRACTORID in \
( select CONTRACTORID from CMSCONTRPEMM where CMSCONTRPEMM.UNITID =?) \
and CMSPERSON.PERSONID = JAIDS.PERSONID) \
and jaids.PERSONID > 1 \
and jaids.DELETEDSW = 0 


business.cms.SELECT_TRADE_IDS_BY_UNIT=\
select distinct TRADEID from CMSSERVICEMASTER where UNITID =?

business.cms.SELECT_SKILL_IDS_BY_UNIT=\
select distinct SKILLID from CMSSERVICEMASTER where UNITID =?


## SAFETY TRAINING
business.cms.SELECT_SAFETY_TRNS = SELECT SAFETYID, NAME, DESCRIPTION from CMSSAFETYTRN
business.cms.SELECT_SAFETY_TRDS=SELECT b.ID, a.NAME, a.DESCRIPTION, b.TRADEID, b.QUALIFICATION, b.AGE, b.CERTIFICATION, b.EXPERIENCE,\
					b.NOOFDAYS FROM CMSSAFETYTRN a,CMSSAFETYTRNTRDMM b \
					WHERE a.SAFETYID = b.SAFETYID
business.cms.SELECT_WORKMEN_SAFETY_TRNS = select a.ID, a.SFTID, a.DATETAKEN, a.FRMTIME, a.TOTIME, a.NEXTDATE, a.TRNDESC, \
a.DEPTID, a.SECID, a.FUNC, a.NJOB, a.MODULE, a.TNI, a.FACULTYNM, a.VENUE, a.PREMO, \
a.premm, a.PREPERCENT, a.POSTMO, a.POSTMM, a.POSTPERCENT,a.RECOM, a.REMARKS, \
a.UPDATEDBY, a.UPDATEDON from CMSPERSONSAFETYMM A, CMSPERSON B where a.PMMID = b.PERSONSAFETYID \
and b.EMPLOYEECODE = ?

business.cms.UPDATE_WORKMEN_SAFETY_TRN=UPDATE CMSPERSONSAFETYMM \
   SET SFTID = ? \
      ,DATETAKEN = ? \
      ,FRMTIME = ? \
      ,TOTIME = ? \
      ,NEXTDATE = ? \
      ,TRNDESC = ? \
      ,DEPTID = ? \
      ,SECID = ? \
      ,FUNC = ? \
      ,NJOB = ? \
      ,MODULE = ? \
      ,TNI = ? \
      ,FACULTYNM = ? \
      ,VENUE = ? \
      ,PREMO = ? \
      ,PREMM = ? \
      ,PREPERCENT = ? \
      ,POSTMO = ? \
      ,POSTMM = ? \
      ,POSTPERCENT = ? \
      ,RECOM = ? \
      ,REMARKS = ? \
      ,UPDATEDBY = ? \
      ,UPDATEDON = ? \
WHERE ID=?

business.cms.INSERT_WORKMEN_SAFETY_TRN=INSERT INTO CMSPERSONSAFETYMM \
           (ID \
           ,SFTID \
           ,DATETAKEN \
           ,FRMTIME \
           ,TOTIME \
           ,NEXTDATE \
           ,TRNDESC \
           ,DEPTID \
           ,SECID \
           ,FUNC \
           ,NJOB \
           ,MODULE \
           ,TNI \
           ,FACULTYNM \
           ,VENUE \
           ,PREMO \
           ,PREMM \
           ,PREPERCENT \
           ,POSTMO \
           ,POSTMM \
           ,POSTPERCENT \
           ,RECOM \
           ,REMARKS \
           ,UPDATEDBY \
           ,UPDATEDON \
           , PMMID) \
     VALUES \
           (? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,?)

business.cms.SELECTMMID = SELECT PMMID FROM CMSPERSONSAFETYMM, CMSPERSON WHERE  CMSPERSON.PERSONSAFETYID = CMSPERSONSAFETYMM.PMMID AND CMSPERSON.EMPLOYEECODE =?
business.cms.INSERT_WORKMEN_SAFETY_ID= UPDATE CMSPERSON SET PERSONSAFETYID = ? WHERE EMPLOYEECODE = ?
business.cms.UPDATECMSPERSON=UPDATE CMSPERSON SET PERSONSAFETYID = NULL WHERE EMPLOYEECODE = ?
business.cms.DELETECMSPERSONSAFETYMM= DELETE FROM CMSPERSONSAFETYMM WHERE PMMID = ?
#merged
#MODIFIED AUTHOR SAM
business.cms.SELECT_WORKMEN_BY_EMP_CODE_UNITID=\
select A.EMPLOYEEID, A.EMPLOYEECODE, A.FIRSTNAME, A.LASTNAME, A.RELATIONNAME, \
A.DOB, A.IDMARK, A.TRADEID, A.SKILLID, A.PRESENTADDRID, A.PERMADDRID, A.PERSONDETLID, \
A.WAGEID,A.CONTRACTORID, A.STATUS, PERSONID, ISLS, A.UNITID, A.ETYPE,A.LTYPE,A.NOJEFFDT from CMSPERSON A, CMSCONTRACTOR B, CMSCONTRPEMM C where \
A.CONTRACTORID = B.CONTRACTORID AND B.CONTRACTORID = C.CONTRACTORID AND C.UNITID = ? \
AND A.EMPLOYEECODE= ? AND A.STATUS  IN (0,1)


business.cms.SELECT_WORKMEN_BY_EMP_CODE=\
select A.EMPLOYEEID, A.EMPLOYEECODE, A.FIRSTNAME, A.LASTNAME, A.RELATIONNAME, \
A.DOB, A.IDMARK, A.TRADEID, A.SKILLID, A.PRESENTADDRID, A.PERMADDRID, A.PERSONDETLID, \
A.WAGEID,A.CONTRACTORID, A.STATUS, PERSONID, ISLS, A.UNITID, A.ETYPE,A.LTYPE,A.NOJEFFDT from CMSPERSON A, CMSCONTRACTOR B, CMSCONTRPEMM C where \
A.CONTRACTORID = B.CONTRACTORID AND B.CONTRACTORID = C.CONTRACTORID \
AND A.EMPLOYEECODE= ? AND A.STATUS  IN (0,1)	
#AND C.UNITID = ? 		
#merged
business.cms.SELECT_WORKMEN_BY_EMP_NAME_UNITID=SELECT A.EMPLOYEEID, A.EMPLOYEECODE, A.FIRSTNAME, A.LASTNAME, A.RELATIONNAME, \
A.DOB, A.IDMARK, A.TRADEID, A.SKILLID, A.PRESENTADDRID, A.PERMADDRID, A.PERSONDETLID, \
A.WAGEID,A.CONTRACTORID, A.STATUS, A.PERSONID, ISLS, A.UNITID, A.ETYPE,A.LTYPE,A.NOJEFFDT  FROM CMSPERSON A, CMSCONTRACTOR B, CMSCONTRPEMM C, VP_EMPLOYMENTSTAT VPE WHERE \
A.CONTRACTORID = B.CONTRACTORID AND B.CONTRACTORID = C.CONTRACTORID AND C.UNITID = ? \
AND (A.FIRSTNAME= ? OR A.LASTNAME = ?) \
AND A.PERSONID = VPE.PERSONID \
AND (VPE.EMPLOYMENTSTATUSDT < = sysdate \
AND VPE.EMPLOYMENTSTATUS=(SELECT SHORTNM FROM EMPLOYMENTSTAT WHERE EMPLOYMENTSTATID=?))

#merged
business.cms.SELECT_WORKMEN_BY_EMP_UNITID=select A.EMPLOYEEID, A.EMPLOYEECODE, A.FIRSTNAME, A.LASTNAME, A.RELATIONNAME, \
A.DOB, A.IDMARK, A.TRADEID, A.SKILLID, A.PRESENTADDRID, A.PERMADDRID, A.PERSONDETLID, \
A.WAGEID,A.CONTRACTORID, A.STATUS, PERSONID, ISLS, A.UNITID,A.ETYPE,A.LTYPE,A.NOJEFFDT from CMSPERSON A, CMSCONTRACTOR B, CMSCONTRPEMM C where \
A.CONTRACTORID = B.CONTRACTORID AND B.CONTRACTORID = C.CONTRACTORID AND C.UNITID = ? AND A.STATUS = 0
						
business.cms.SELECT_SAFETY_VLNS=SELECT VIOLATIONID, VIOLATIONNAME, VIOLATIONDESC from CMSSAFETYVIOLATION
business.cms.SELECTVIOLATIONMMID=SELECT CMSPERSONVIOLATIONMM.PMMID FROM CMSPERSONVIOLATIONMM, CMSPERSON WHERE  CMSPERSON.PERSONSAFETYVIOLID = CMSPERSONVIOLATIONMM.PMMID AND CMSPERSON.EMPLOYEECODE =?
business.cms.UPDATECMSPERSONSAFETYVIOLID=UPDATE CMSPERSON SET PERSONSAFETYVIOLID = NULL WHERE EMPLOYEECODE = ?
business.cms.DELETECMSPERSONVIOLATIONMM=DELETE FROM CMSPERSONVIOLATIONMM WHERE PMMID = ?
business.cms.INSERT_WORKMEN_SAFETY_VIOLATION=INSERT INTO CMSPERSONVIOLATIONMM \
           (ID \
           ,VIOLATIONID \
           ,SFTVIOLTEXT \
           ,STFVIOLDT \
           ,ACTION \
           ,UPDATEDBY \
           ,UPDATEDON \
           ,PMMID) \
     VALUES \
           (? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,?) 

business.cms.INSERT_WORKMEN_SAFETY_VIOLATION_ID=UPDATE CMSPERSON SET PERSONSAFETYVIOLID = ? WHERE EMPLOYEECODE = ?

business.cms.SELECT_WORKMEN_SAFETY_VIOLATIONS=\
SELECT ID \
      ,VIOLATIONID \
      ,SFTVIOLTEXT \
      ,STFVIOLDT \
      ,ACTION \
      ,UPDATEDBY \
      ,UPDATEDON \
      ,PMMID \
  FROM CMSPERSONVIOLATIONMM, CMSPERSON WHERE CMSPERSONVIOLATIONMM.PMMID=CMSPERSON.PERSONSAFETYVIOLID AND EMPLOYEECODE = ?

business.cms.SELECT_HEALTH_INFORMATIONS=\
SELECT ID \
      ,NAME \
      ,DETAIL \
      ,DOT \
      ,CONCERN \
      ,NEXTDOT \
      ,UPDATEDBY \
      ,UPDATEDON \
      , PMMID \
  FROM CMSPERSONHLTMM, CMSPERSON WHERE CMSPERSONHLTMM.PMMID=CMSPERSON.PERSONHLTID AND EMPLOYEECODE = ?

business.cms.UPDATECMSPERSONHLTMM= UPDATE CMSPERSON SET PERSONHLTID = NULL WHERE EMPLOYEECODE = ?
business.cms.DELETECMSPERSONHLTMM=DELETE FROM CMSPERSONHLTMM WHERE PMMID = ?
business.cms.SELECTCMSPERSONHLTMMID=SELECT CMSPERSONHLTMM.PMMID FROM CMSPERSONHLTMM, CMSPERSON WHERE  CMSPERSON.PERSONHLTID = CMSPERSONHLTMM.PMMID AND CMSPERSON.EMPLOYEECODE =?
business.cms.INSERT_WORKMEN_HEALTH_INFORMATION=\
INSERT INTO CMSPERSONHLTMM \
           (ID \
           ,NAME \
           ,DETAIL \
           ,DOT \
           ,CONCERN \
           ,NEXTDOT \
           ,UPDATEDBY \
           ,UPDATEDON \
           , PMMID) \
     VALUES \
           (? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,? \
           ,?)
business.cms.INSERT_WORKMEN_HEALTH_INFORMATION_ID=UPDATE CMSPERSON SET PERSONHLTID = ? WHERE EMPLOYEECODE = ?
business.cms.SELECT_SECTION_BY_ID=SELECT SECID, NAME, CODE, DESCRIPTION, DEPTID FROM CMSSECTION WHERE SECID=? order by NAME
business.cms.CHECK_WORKMEN_EMPCODE=SELECT CASE WHEN EXISTS (SELECT EMPLOYEECODE FROM CMSPERSON WHERE EMPLOYEECODE=?) THEN 'TRUE' ELSE 'FALSE' END FROM DUAL
business.cms.SELECT_SCHEDULE_WORKMEN=  {call dbo.scheduledisplay(?,?,?)}

business.cms.SELECT_WORKORDERS_BY_CONTRID=\
SELECT WORKORDERID \
       ,UNITID \
      ,CONTRACTORID \
      ,NAME \
      ,VALIDFROM \
      ,VALIDDT \
      ,TYPEID \
      ,DEPID \
      ,SECID \
      ,GLCODE \
      ,COSTCENTER \
      ,OWNERID \
      ,SUPRID \
      ,STATUS \
      ,SAP_WORKORDER_NUM \
  FROM CMSWORKORDER WHERE CONTRACTORID=?

business.cms.GET_NEW_WORKMEN_CODE_BY_UNITCODE=  {call dbo.MD_WORKMEN_EMPCODEGEN(?,?,?,?,?)}
business.cms.GENERATE_WORKMEN_EMPCODE=\
SELECT MAX(COUNTER)+1 FROM CMSEMPSEQUENCE where UNITID=?

business.cms.UPDATE_EMP_SEQUENCE_TABLE=\
UPDATE CMSEMPSEQUENCE SET COUNTER = COUNTER+1 where UNITID=?

#MODIFIED BY SAM
business.cms.CHECK_PF_ESI_AADHAR_UNIQUENESS= \
SELECT PERSONNUM FROM VP_PERSONCUSTDATA VPC JOIN VP_EMPLOYMENTSTAT VPE ON VPC.PERSONID = VPE.PERSONID AND VPE.EMPLOYMENTSTATUS = 'Active' \
WHERE VPC.CUSTOMDEFNAME='ESICWC' AND  UPPER(VPC.CUSTOMDATA)=UPPER(?) \
UNION \
SELECT EMPLOYEECODE FROM CMSPERSON CP  JOIN CMSPERSONDETL CPD ON CPD.PERSONDETLID = CP.PERSONDETLID JOIN VP_EMPLOYMENTSTAT VPE \
ON CP.PERSONID = VPE.PERSONID AND VPE.EMPLOYMENTSTATUS ='Active' WHERE  CPD.AADHARNO=? OR UPPER(CPD.PFANO)=UPPER(?)
#SELECT PERSONNUM FROM VP_PERSONCUSTDATA VPC JOIN VP_EMPLOYMENTSTAT VPE ON VPC.PERSONID = VPE.PERSONID WHERE VPE.EMPLOYMENTSTATUS = 'Active' \
#AND VPC.CUSTOMDEFNAME='ESICWC' AND  UPPER(VPC.CUSTOMDATA)=UPPER(?) \
#UNION \
#SELECT EMPLOYEECODE FROM CMSPERSON CP  JOIN CMSPERSONDETL CPD ON CPD.PERSONDETLID = CP.PERSONDETLID JOIN VP_EMPLOYMENTSTAT VPE \
#ON CP.PERSONID = VPE.PERSONID WHERE VPE.EMPLOYMENTSTATUS = 'Active' AND CPD.AADHARNO=? OR UPPER(CPD.PFANO)=UPPER(?)
##SELECT PERSONNUM FROM VP_PERSONCUSTDATA WHERE CUSTOMDEFNAME='ESICWC' AND UPPER(CUSTOMDATA)=UPPER(?) UNION \
##SELECT EMPLOYEECODE FROM CMSPERSON A INNER JOIN CMSPERSONDETL B ON A.PERSONDETLID=B.PERSONDETLID JOIN VP_EMPLOYEEV42 VPE \
##ON VPE.PERSONNUM = A.EMPLOYEECODE WHERE VPE.EMPLOYMENTSTATID='1' AND UPPER(B.AADHARNO)=UPPER(?) OR UPPER(B.PFANO)=UPPER(?)

business.cms.SELECT_GET_AGE_BY_DOB=\
select trunc(months_between(sysdate,dob)/12) year from (Select to_date(?,'YYYY-MM-DD') dob from dual)

business.cms.SELECT_GET_WORKORDER_TYPE_Id=\
SELECT WO.TYPEID FROM CMSWORKORDER WO JOIN CMSWORKORDERLN WL ON WO.WORKORDERID=WL.WORKORDERID WHERE WL.WORKORDERLNID=?

business.cms.SELECT_GET_BALANCE_QTY=\
select distinct (SELECT  distinct QTY  FROM CMSWORKORDERLN WL JOIN CMSWORKORDER WO ON WL.WORKORDERID=WO.WORKORDERID \
WHERE workorderlnid = ?) - (select  NVL((sum(DURATIONSECSQTY)/3600/8),0) from WFCTOTAL where LABORACCTID in \
(select distinct LABORACCTID from LABORACCT where LABORLEV6NM = (select distinct SAP_WORKORDER_NUM from \
cmsworkorder wo join cmsworkorderln wl on wo.workorderid=wl.workorderid \
where workorderlnid = ?) || '-' || ? || '-' || ?) and paycodeid in (select distinct  paycodeid from paycode \
where name in('Extra_hours_8','Extra_hours_12','Regular-8','Regular-12') ) and applydtm between (select distinct \
VALIDFROM from CMSWORKORDER w where SAP_WORKORDER_NUM=(select distinct SAP_WORKORDER_NUM from cmsworkorder wo join \
cmsworkorderln wl on wo.workorderid=wl.workorderid where workorderlnid = ?) and w.unitid=? and rownum=1 ) \
and SYSDATE) as result from dual

business.cms.SELECT_WORKORDER_BY_UNITID_CONTRID=\
select distinct cw.WORKORDERID,cw.SAP_WORKORDER_NUM,substr(ITEM_NAME,instr(ITEM_NAME,'~',1,1)+1, \
(instr(ITEM_NAME,'~',1,2)-(instr(ITEM_NAME,'~',1,1))-1)) Department, SECID \
from cmsworkorderln cl join CMSWORKORDER cw on cw.WORKORDERID=cl.WORKORDERID where cl.ITEM_NAME like CONCAT( ?, '%' ) and cw.CONTRACTORID=? and cw.STATUS in (1,2)

business.cms.SELECT_WORKORDERLINE_BY_UNITID_CONTRID=\
select distinct cw.WORKORDERID,cl.WORKORDERLNID, cl.ITEM_NUM || '-' || cl.SERVICE_LN_ITEM_NUM from \
cmsworkorderln cl join CMSWORKORDER cw on cw.WORKORDERID=cl.WORKORDERID where \
UNITID=? and CONTRACTORID=? and cw.STATUS in (1,2)

business.cms.CHECK_LABOR_LEV6=\
select count(*) from LABORLEVELENTRY where LABORLEVELDEFID=6 AND NAME=?

business.cms.UPDATE_CONTRACTOR_WC=\
update CMSCONTRACTOR_WC set WC_CODE=? , CONTRACTORID=?, UNITID=?, WC_FROM_DTM=?, WC_TO_DTM=?,\
 WC_TOTAL=?, UPDATED_DTM=? where CONTRACTORID=?  AND UNITID=? and WC_NUMBER=?
 
 business.cms.SELECT_CONTRACTOR_WC=\
 SELECT WCID,WC_CODE,WC_FROM_DTM,WC_TO_DTM,WC_TOTAL,WC_NUMBER FROM CMSCONTRACTOR_WC \
 WHERE CONTRACTORID=? AND UNITID=? AND WC_NUMBER IN ('WC1','WC2','WC3','WC4')
 
 business.cms.SELECT_SECTION_ID=\
 SELECT SECID FROM CMSSECTION WHERE NAME=? AND DEPTID=?
 
 business.cms.GET.NEW.EMPLOYEECODE = SELECT EmployeeCodeGen (?) FROM DUAL
 
 business.cms.UPDATE.COUNTER=\
 CALL UPDATECOUNTER (?)











 business.cms.SELECT_GET_EXP_BY_DOJ=\
 select trunc(months_between(sysdate,doj)/12) year from (Select to_date(?,'YYYY-MM-DD') doj from dual)
 
 
 select.business.cms.GET_DATA = \
 SELECT NAME FROM CMSLABORTYPE;							   
 
business.cms.SELECT_SUPPLY = \
 select SUPPLYID, NAME from CMSSUPPLY									 
 
 business.cms.SELECT_ALL_SUPPLY = \
 select SUPPLYID, NAME from CMSSUPPLY									 
 

 business.cms.SELECT_SECTION_ID2=\
 SELECT SECID FROM CMSSECTION WHERE NAME=? AND DEPTID=?

business.cms.SELECT_AllInterfaceNames= \
select  KNXINTERFACEID, KNXINTERFACENM, KNXINTERFACEDSC FROM KNXINTERFACE

business.cms.SELECT_InterfaceNames= \
select  KNXINTERFACEID, KNXINTERFACENM, KNXINTERFACEDSC FROM KNXINTERFACE where KNXINTERFACEID in (SELECT IDENTIFIERID FROM DAGITEM WHERE DATAACCESSGRPID in (select a.DATAACCESSGRPID from ASSIGNDAG a inner join DATAACCESSGRP d on a.DATAACCESSGRPID=d.DATAACCESSGRPID where PERSONID =?) AND DAGENTITYID = (select dagentity.DAGENTITYID from dagentity where dagentitynm like '%interfaces'))
# business.cms.SELECT_AllInterfaceNames= select PROPERTYNAME from KTC_FILEUPLOADPROPERTIES

business.cms.SELECT_FILEUPLOAD_DETAILS_BY_PROPERY_NAME=\
SELECT PROPERTYNAME,INTERFACENAME,LINKNAME,VARIABLENAME FROM KTC_FILEUPLOADPROPERTIES WHERE PROPERTYNAME=?
 business.cms.SELECT_AllInterfacesNames= \
select PROPERTYNAME from KTC_FILEUPLOADPROPERTIES

business.cms.SELECT_ALL_REASONFOFLEAVING_LIST= SELECT NAME FROM CMSREASONOFLEAVINGLIST


#New querys
business.cms.INSERT_CMSPERSON1=\
INSERT INTO CMSPERSON1 (EMPLOYEEID1,EMPLOYEECODE,FIRSTNAME,LASTNAME,RELATIONNAME,DOB,IDMARK,TRADEID,SKILLID,PRESENTADDRID,PERMADDRID,PERSONDETLID,WAGEID,CONTRACTORID,STATUS,PERSONID,ISLS,UNITID, ETYPE, LTYPE, NOJEFFDT, FROM_ORG_UNIT_ID) \
VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)

business.cms.INSERT_PERSONDETL1=\
INSERT INTO CMSPERSONDETL1 VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,NULL,?,?)
 
business.cms.INSERT_CMSADDRESS1=\
INSERT INTO CMSADDRESS1 VALUES(?,?,?,?,?,?)

business.cms.SELECT.Max.AddressID1= select NVL(max(ADDRESSID),0)+1 from CMSADDRESS1

business.cms.SELECT.Max.PersonDetId1=select NVL(max(PERSONDETLID),0)+1 from CMSPERSONDETL1

business.cms.SELECT.Max.Person1=select NVL(max(EMPLOYEEID1),0)+1 from CMSPERSON1

business.cms.GET.NEW.TRANSACTIONID = SELECT NVL(CMSTRANSACTIONID,0) from CMSTRANSACTION
 
business.cms.UPDATE.NEW.TRANSACTIONID = UPDATE CMSTRANSACTION SET CMSTRANSACTIONID=(SELECT NVL(CMSTRANSACTIONID,0)+1 from CMSTRANSACTION)
 
business.cms.SELECT_PERSONDETL_BY_ID1=\
SELECT PERSONDETLID \
      ,DOJ \
      ,DOT \
      ,PFANO \
      ,AADHARNO\
      ,GENDER\
      ,PANNO\
      ,HAZAREA\
      ,MARITAL\
      ,WIFENM\
      ,CHLDRNO\
      ,TECH\
      ,ACADS\
      ,PLIC1\
      ,PLIC2\
      ,PLIC3\
      ,PLIC4\
      ,PEMP\
      ,PCONTR\
      ,REFERREDBY\
      ,SHOESIZE\
      ,BLOODGRP\
      ,AMCDTM\
      ,WINCORELATIVE\
      ,WINCONAME\
      ,WINCOMADDRESSID\
      ,MOBILENO\
      ,LANDLOSER\
      ,SURVEYNO\
      ,RELWITHSLLR\
      ,VILLAGE\
      ,NAMEOFSELLER\
      ,EXTENT\
      ,ACTCONTRSW\
      ,BANKBRANCH\
      ,ACCTNO\
      ,MEDICALTRNSW\
      ,SAFETYTRNSW\
      ,SKILLCERTSW \
      , Experience  \
      , PrevOgranization ,INACTIVEDATE,REASONOFLEAVING,OTHERREASONOFLEAVING \
  FROM CMSPERSONDETL1 WHERE PERSONDETLID=?
   
#business.cms.SELECT_WORKMEN_BY_CONTID1=\
#SELECT EMPLOYEEID1, EMPLOYEECODE, FIRSTNAME, LASTNAME, RELATIONNAME,DOB, IDMARK, TRADEID, SKILLID, PRESENTADDRID, PERMADDRID, PERSONDETLID, \
#WAGEID, CONTRACTORID, STATUS, CP.PERSONID, ISLS, UNITID FROM CMSPERSON1 CP WHERE CONTRACTORID=? AND CP.STATUS=?

# $
business.cms.SELECT_WORKMEN_BY_CONTID1=\
SELECT EMPLOYEEID1, EMPLOYEECODE, FIRSTNAME, LASTNAME, RELATIONNAME,DOB, IDMARK, TRADEID, SKILLID, PRESENTADDRID, PERMADDRID, PERSONDETLID, \
WAGEID, CONTRACTORID, STATUS, CP.PERSONID, ISLS, UNITID, ETYPE, LTYPE, NOJEFFDT, FROM_ORG_UNIT_ID  FROM CMSPERSON1 CP inner join cmspersonext CPE on cp.EMPLOYEEID1=CPE.EMPLOYEEID \
 WHERE CONTRACTORID=? AND CP.STATUS=? AND CP.UNITID = ?

business.cms.SELECT_WORKMEN_BY_CONTID_EMPCODE1=\
SELECT EMPLOYEEID1, EMPLOYEECODE, FIRSTNAME, LASTNAME, RELATIONNAME,DOB, IDMARK, TRADEID, SKILLID, PRESENTADDRID, PERMADDRID, PERSONDETLID, \
WAGEID, CONTRACTORID, STATUS, CP.PERSONID, ISLS, UNITID, ETYPE, LTYPE, NOJEFFDT, FROM_ORG_UNIT_ID  FROM CMSPERSON1 CP inner join cmspersonext CPE on cp.EMPLOYEEID1=CPE.EMPLOYEEID \
WHERE CP.CONTRACTORID = ? AND CP.EMPLOYEECODE=? AND CP.STATUS=? AND CP.UNITID = ?

business.cms.SELECT_WORKMEN_BY_CONTID_EMPNAME1=\
SELECT EMPLOYEEID1, EMPLOYEECODE, FIRSTNAME, LASTNAME, RELATIONNAME,DOB, IDMARK, TRADEID, SKILLID, PRESENTADDRID, PERMADDRID, PERSONDETLID,WAGEID, CONTRACTORID, STATUS, \
CP.PERSONID, ISLS, UNITID, ETYPE, LTYPE, NOJEFFDT, FROM_ORG_UNIT_ID  FROM CMSPERSON1 CP inner join cmspersonext CPE on cp.EMPLOYEEID1=CPE.EMPLOYEEID \
WHERE CP.CONTRACTORID = ? AND (FIRSTNAME like ? or LASTNAME like ?) AND CP.STATUS=? AND CP.UNITID = ?
	
business.cms.INSERT.CMSPERSONEXT= \
insert into CMSPERSONEXT (EMPLOYEEID,ACTION,DepartmentID,SECID,WORKORDER,ItemServiceNumber,EmpType,LaborType,VDA,PDA,HRA,Conveyance,SpecialAllowance,ShiftAllowance,\
DustAllowance,Medical,LTA,EducationAnnual,ESICWC,ESICExempt,PFExempt,SafetyTrainingDate,Gender,PrevExp,PrevOrg,AadharNumber,MobileNumber,VehicleType,\
VehicleRent,QuarterRent,ShiftHours,WageEffDate,EffDate) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?) 

	

business.cms.SELECT_WORKMENEXT_BY_EMPID=\
SELECT EMPLOYEEID,ACTION,DepartmentID,SECID,WORKORDER,ItemServiceNumber,EmpType,LaborType,VDA,PDA,HRA,Conveyance,SpecialAllowance,ShiftAllowance, \
DustAllowance,Medical,LTA,EducationAnnual,ESICWC,ESICExempt,PFExempt,SafetyTrainingDate,Gender,PrevExp,PrevOrg,AadharNumber,MobileNumber,VehicleType, \
VehicleRent,QuarterRent,ShiftHours,WageEffDate,EffDate FROM CMSPERSONEXT where EMPLOYEEID=?

business.cms.SELECT_ADDRESS_BY_ID1=\
SELECT ADDRESSID,STREET,TALUKA, DISTRICT, VILLAGE,STATEID FROM CMSADDRESS1 WHERE ADDRESSID=?

business.cms.SELECT_ISAPPROVER_BY_EMPID= \
SELECT ISAPPROVER,EMPLOYEENO FROM CMSREQAPPROVER WHERE EMPLOYEENO=?

business.cms.UPDATE.PERSON_STATUS_BY_EMPID= update CMSPERSON1 set STATUS=? where EMPLOYEEID1=?

business.cms.SELECT_PENDING_EMPID_BY_EMPNO_AND_STATUS= select EMPLOYEEID1 from CMSPERSON1 where EMPLOYEECODE=? and STATUS=?

business.cms.UPDATE.PERSON_STATUS_BY_EMPID1=update CMSPERSON1 set STATUS=(select NVL(max(status)+10,0) from cmsperson1) where EMPLOYEEID1=?

business.cms.INSERT.IMAGE_HIREDATE_BY_EMPID1= insert into CMSIMAGEREHIREDATE(EMPLOYEEID,IMAGEDATA,REHIREDATE) values(?,?,?)

business.cms.SELECT.IMAGE_HIREDATE_BY_EMPID1= select EMPLOYEEID,IMAGEDATA,REHIREDATE from CMSIMAGEREHIREDATE where EMPLOYEEID=?

business.cms.UPDATE.PERSON_STATUS_NUM_BY_EMPID1= update CMSPERSON1 set STATUS= ? where EMPLOYEEID1=?

#merged
business.cms.SELECT_WORKMEN_BY_ID1=\
select EMPLOYEEID1, EMPLOYEECODE, FIRSTNAME, LASTNAME, RELATIONNAME,\
DOB, IDMARK, TRADEID, SKILLID, PRESENTADDRID, PERMADDRID,PERSONDETLID,\
WAGEID,CONTRACTORID, STATUS, PERSONID, ISLS, UNITID, ETYPE, LTYPE, NOJEFFDT, FROM_ORG_UNIT_ID from CMSPERSON1 where EMPLOYEEID1 = ?

#AUTHOR SAM
business.cms.SELECT_CONTRACTOR_WITH_STATUS=\
select distinct A.CONTRACTORID ,B.UNITID, NAME, ADDRESS,CODE,MANAGERNM,ESIWC ,LICENSENUM,VALIDFROMDT,VALIDTODT,\
COVERAGE,TOTALSTRENGTH,MAXNOEMP,NATUREOFWORK,LOCOFWORK ,PERIODSTARTDT,	PERIODENDDT ,VENDORCODE, PFCODE,\
ESIVALIDFROM ,ESIVALIDTO,ESIWCCOVERAGE,PFNUM,PFAPPLYDT, IS_BLOCKED,COMMISSION,PFCOVERAGE, PFPAIDBYSELF,\
ESIPAIDBYSELF,LICENSENUM1,VALIDFROMDT1,VALIDTODT1, D.STATUS from CMSCONTRACTOR A JOIN CMSCONTRPEMM B ON \
A.CONTRACTORID = B.CONTRACTORID	JOIN CMSVENDOR C ON B.VENDORID = C.VENDORID JOIN CMSPERSON1 D \
ON A.CONTRACTORID = D.CONTRACTORID AND B.UNITID = D.UNITID WHERE  D.UNITID = ? AND D.STATUS = ? OR A.NAME LIKE ? OR C.VENDORCODE= ? order by NAME
#select DISTINCT cMSCONTRACTOR.*  from cMSCONTRACTOR, CMSPERSON1, CMSCONTRPEMM, CMSVENDOR WHERE cMSCONTRACTOR.CONTRACTORID =CMSCONTRPEMM.CONTRACTORID AND cMSCONTRACTOR.CONTRACTORID =CMSPERSON1.CONTRACTORID AND CMSCONTRPEMM.VENDORID = CMSVENDOR.VENDORID  AND CMSCONTRPEMM.UNITID=? order by NAME
#newly added
business.cms.SELECT_REAL_EMP_ID_EMPCODE_UNITID=\
SELECT EMPLOYEEID FROM CMSPERSON WHERE EMPLOYEECODE = ? AND UNITID = ?
#SELECT CP.EMPLOYEEID FROM CMSPERSON CP JOIN VP_EMPLOYEEV42 VE ON CP.PERSONID = VE.PERSONID WHERE VE.EMPLOYMENTSTATID = 1 \
#AND CP.EMPLOYEECODE = ? AND CP.UNITID = ?
business.cms.INSERT_WAGE_HISTORY=\
INSERT INTO CMSWAGEHIST (WAGEID, PERSONID, PERSONNUM, BASIC, DA, ALLOWANCE, PERDAYALLOWANCE, MONTHLYALLOWANCE, COMMISSION, EFFECTIVEDATE, \
VDA , PDA , HRA , CONVEYANCE , SPECIAL_ALLOWANCE , SHIFT_ALLOWANCE , DUST_ALLOWANCE_MONTHLY , MEDICAL_ALLOWANCE , LTA , EDUCATION_ALLOWANCE , \
OTHER_ALLOWANCE, COMMISSION_AMT, FITMENT_ALLOWANCE  , RETENTION_ALLOWANCE  , GUN_ALLOWANCE  , UNIFORM_ALLOWANCE ,VARIABLE_ALLOWANCE_AMT,	\
TA,	SKILL_DEVELOPMENT_ALLOWANCE, DEP_COMP_ALLOW,	WASHING_ALLOWANCE,	SITE_ALLOWANCE,	MOBILE_ALLOWANCE,	SKILLED_ALLOWANCE,PF,ESIC,\
ADMIN_CHARGES,	ADMIN_EDLI,	TOOLS_AND_TACKLES,	CONSULTANCY_CHARGES,	ADVANCE_BONUS,	ENTERTAINMENT_EXPENSES,	CLUB_EXPENSES,	\
VEHICLE_REIMBURSEMENT,	VEHICLE_EXPENSE_REIMBURSEMENT,	FUEL_EXPENSES,	FUEL_EXPENSES_1,	PERIODICAL_MAGAZINE_EXPENSES,	PERSONAL_PAY,	\
INCENTIVE_ALL,	ADDITIONAL_ALLOWANCE,	ADDITIONAL_ALLOWANCE_2,	ADDITIONAL_ALLOWANCE_3,	PENSION ) \
VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
#INSERT INTO CMSWAGEHIST (WAGEID, PERSONID, PERSONNUM, BASIC, DA, ALLOWANCE, PERDAYALLOWANCE, MONTHLYALLOWANCE, COMMISSION, EFFECTIVEDATE) \
#VALUES(?,?,?,?,?,?,?,?,?,?)
#new
business.cms.SELECT_WORKMEN_BY_CONTID_AADHAAR1=\
SELECT EMPLOYEEID1, EMPLOYEECODE, FIRSTNAME, LASTNAME, RELATIONNAME,DOB, IDMARK, TRADEID, SKILLID, PRESENTADDRID, PERMADDRID, CP.PERSONDETLID, \
WAGEID, CONTRACTORID, STATUS, CP.PERSONID, ISLS, UNITID, ETYPE, LTYPE, NOJEFFDT, FROM_ORG_UNIT_ID  FROM CMSPERSON1 CP JOIN CMSPERSONDETL1 CPD on CP.PERSONDETLID=CPD.PERSONDETLID \
WHERE CP.CONTRACTORID = ? AND CPD.AADHARNO=? AND CP.STATUS=? AND CP.UNITID = ?

business.cms.SELECT_WORKMEN_BY_CONTID_AADHAAR=\
SELECT CP.EMPLOYEEID, EMPLOYEECODE, FIRSTNAME, LASTNAME, RELATIONNAME,DOB, IDMARK, TRADEID, SKILLID, PRESENTADDRID, PERMADDRID, CPD.PERSONDETLID, \
WAGEID, CONTRACTORID, STATUS, CP.PERSONID, ISLS, UNITID, ETYPE, LTYPE, NOJEFFDT  FROM CMSPERSON CP JOIN CMSPERSONDETL CPD on CP.PERSONDETLID=CPD.PERSONDETLID \
JOIN VP_EMPLOYEEV42 VPE ON CP.EMPLOYEECODE = VPE.PERSONNUM \
WHERE CP.CONTRACTORID = ? AND CPD.AADHARNO= ? AND VPE.EMPLOYMENTSTATID=? AND CP.UNITID = ?
#DOCUMENT
business.cms.SELECT_BY_UNIT_EMPCODE=\
SELECT DID,EMPID,EMPLOYEECODE,CATCODE,TYPECODE,FILEPATH,EFFDT,DESCRIPTION,UPLOADDT FROM CMSDOCUMENTHISTORY \
WHERE EMPLOYEECODE = ? 
#OR EMPID = ?  AND CATCODE = ? OR TYPECODE = ? 

business.cms.INSERT_DOC_HISTORY=\
INSERT INTO CMSDOCUMENTHISTORY (EMPID,EMPLOYEECODE,CATCODE,TYPECODE,FILEPATH,EFFDT,DESCRIPTION) \
VALUES (?,?,?,?,?,?,?)
#INSERT INTO CMSDOCUMENTHISTORY (DID,EMPID,EMPLOYEECODE,CATCODE,TYPECODE,FILEPATH,EFFDT,DESCRIPTION) \
#VALUES (DOC_SEQUENCE.NEXTVAL,?,?,?,?,?,?,?)


business.cms.UPDATE_DOC_HISTORY=\
UPDATE CMSDOCUMENTHISTORY SET EMPID = ? ,EMPLOYEECODE = ? FILEPATH = ? \
WHERE EMPID = ? AND EMPLOYEECODE = ?

business.cms.GET_ALL_DOCUMENT_CATEGORIES=\
SELECT CATCODE,CATNAME FROM CMSDOCUMENTCATEGORY

business.cms.GET_ALL_DOCUMENT_TYPES=\
SELECT CATCODE,TYPECODE,TYPENAME FROM CMSDOCUMENTTYPE ORDER BY CATCODE

business.cms.GET_UNIT_NAME_BY_EMPCODE=\
SELECT CPE.NAME, CPE.CODE FROM CMSPRINCIPALEMPLOYER CPE WHERE UNITID IN ( SELECT CP.UNITID CP_UNITID FROM CMSPERSON CP JOIN \
VP_EMPLOYMENTSTAT VPE ON VPE.PERSONID = CP.PERSONID  WHERE VPE.EMPLOYMENTSTATUS = 'Active' AND CP.EMPLOYEECODE = ? )
#SELECT CPE.NAME, CPE.CODE FROM CMSPRINCIPALEMPLOYER CPE WHERE UNITID IN ( SELECT CP.UNITID CP_UNITID FROM CMSPERSON CP  WHERE CP.EMPLOYEECODE = ?) \
#OR  UNITID IN (SELECT CP1.UNITID CP1_UNITID FROM CMSPERSON1 CP1 WHERE CP1.EMPLOYEECODE = ?)
#NOTIFICAION 
#AUTHOR SAM
business.cms.INSERT_NOTIFICATION=\
INSERT INTO CMS_EMAIL_NOTIFICATION_TBL \
(CREATEDBY,UNITID,EMPLOYEECODE,AADHAARNO,EMPLOYEESTATUS,ESUBJECT,ECONTENT,FROMEMLID,CCEMAILID,TOEMLID,EMAILSTATUS,REMINDERCOUNT) \
VALUES (?,?,?,?,?,?,?,?,?,?,?,?)
#INSERT INTO CMS_EMAIL_NOTIFICATION_TBL \
#(NOTID,CREATEDBY,UNITID,EMPLOYEECODE,AADHAARNO,EMPLOYEESTATUS,ESUBJECT,ECONTENT,FROMEMLID,CCEMAILID,TOEMLID,EMAILSTATUS,REMINDERCOUNT) \
#VALUES (NOTIF_SEQUENCE.NEXTVAL,?,?,?,?,?,?,?,?,?,?,?,?)


business.cms.SELECT_MANAGERS_BY_UNITID=\
SELECT MANAGERID, CM.NAME,DEPID, SECID, USERNAME, PASSWORD, EMAILADDR, MOBILENO, ISDEPTMGR, CM.PERSONID \
FROM CMSMANAGERS CM JOIN VP_ALLPERSONV42 VPE ON CM.PERSONID = VPE.PERSONID JOIN CMSPRINCIPALEMPLOYER CPE \
ON CPE.CODE = VPE.HOMELABORLEVELNM2 WHERE CPE.UNITID = ? AND VPE.EMPLOYMENTSTATUS = 'Active' \
AND CM.ISDEPTMGR ='1' ORDER BY MANAGERID DESC

business.cms.SELECT_CREATOR_EMAIL_BY_EMPCODE_AADHAAR_EMPSTATUS=\
SELECT TOEMLID,CCEMAILID, ROWNUM FROM CMS_EMAIL_NOTIFICATION_TBL WHERE EMPLOYEECODE = ? AND AADHAARNO = ? \
AND EMPLOYEESTATUS = ? AND UNITID = ? AND ROWNUM = 1 ORDER BY EMPLOYEECREATIONDT DESC
#SELECT TOP 1 TOEMLID,CCEMAILID FROM CMS_EMAIL_NOTIFICATION_TBL WHERE EMPLOYEECODE = ? AND AADHAARNO = ? \
#AND EMPLOYEESTATUS = ? AND UNITID = ? ORDER BY EMPLOYEECREATIONDT DESC

business.cms.GET_ALL_LOCATIONS=\
CALL GET_ALL_LOCATIONS (?, ?, ?)

business.cms.FUNC_GET_ALL_LOCATIONS=\
SELECT GET_ALL_LOCATIONS (?, ?) FROM DUAL

business.cms.PROC_GET_ALL_LOCATIONS=\
CALL PROC_GET_ALL_LOCATIONS (?, ?, ?)

business.cms.PROC_GET_ALL_DEPTS=\
CALL PROC_GET_ALL_DEPTS (?, ?, ?)

business.cms.PROC_GET_ALL_SECTS=\
CALL PROC_GET_ALL_SECTS (?, ?, ?, ?)

business.cms.PROC_GET_ALL_WORKORDERS=\
CALL PROC_GET_ALL_WORKORDERS (?, ?, ?, ?, ?, ?, ?)

business.cms.PROC_GET_WORKORDERS_SAP_SES=\
CALL PROC_GET_WORKORDERS_SAP_SES (?, ?, ?)

business.cms.PROC_GET_SES_PAYLOAD=\
CALL PROC_GET_SES_PAYLOAD_FROM_BVR (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
#CALL PROC_GET_SES_PAYLOAD (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)

business.cms.PROC_UPDATE_WORKORDER_SAP_SES=\
CALL PROC_UPDATE_WORKORDER_SAP_SES (?, ?, ?, ?, ?)

business.cms.PROC_DELETE_WORKORDER_SAP_SES=\
CALL PROC_DELETE_WORKORDER_SAP_SES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)

business.cms.FUNC_REQ_VAL=\
SELECT FUNC_SES_REQ_VAL (?, ?, ?, ?, ?, ?, ?, ?, ?) FROM DUAL
#SELECT FUNC_REQ_VAL (?, ?, ?, ?, ?, ?, ?, ?, ?) FROM DUAL

business.cms.CMS.REQ.VALIDATION = SELECT FUNC_CMS_REQ_VALIDATION (?) FROM DUAL


business.cms.UPDATE_CMSPERSON1=\
UPDATE CMSPERSON1 SET EMPLOYEECODE = ? , PERSONID = ? WHERE WAGEID = ?

business.cms.SELECT_WORKMEN_BY_EMPID_FOR_REHIRE=\
SELECT DISTINCT A.EMPLOYEEID, A.EMPLOYEECODE, A.FIRSTNAME, A.LASTNAME, A.RELATIONNAME, \
A.DOB, A.IDMARK, A.TRADEID, A.SKILLID, A.PRESENTADDRID, A.PERMADDRID, A.PERSONDETLID, \
A.WAGEID,A.CONTRACTORID, A.STATUS, PERSONID, ISLS, A.UNITID, A.ETYPE,A.LTYPE,A.NOJEFFDT from CMSPERSON A, CMSCONTRACTOR B, CMSCONTRPEMM C where \
A.CONTRACTORID = B.CONTRACTORID AND B.CONTRACTORID = C.CONTRACTORID AND A.EMPLOYEEID = ? \
AND A.STATUS IN (0,1)


business.cms.SELECT_CONTRACTOR_BY_ID_FOR_WORKMEN_REHIRE=\
select A.CONTRACTORID ,UNITID, NAME, ADDRESS,CODE,MANAGERNM,ESIWC ,LICENSENUM,VALIDFROMDT,VALIDTODT,COVERAGE,TOTALSTRENGTH,MAXNOEMP,\
NATUREOFWORK,LOCOFWORK ,PERIODSTARTDT,	PERIODENDDT ,VENDORCODE ,PFCODE ,ESIVALIDFROM ,ESIVALIDTO, ESIWCCOVERAGE ,PFNUM,PFAPPLYDT,IS_BLOCKED,COMMISSION, \
PFCOVERAGE, PFPAIDBYSELF, ESIPAIDBYSELF, LICENSENUM1,VALIDFROMDT1,VALIDTODT1 \
from cMSCONTRACTOR A, CMSCONTRPEMM B, CMSVENDOR C WHERE A.CONTRACTORID =B.CONTRACTORID AND B.VENDORID = C.VENDORID AND A.CONTRACTORID=? \
and UNITID = ? order by NAME